{"version":3,"sources":["components/Alert.tsx","components/Asset.tsx","util.ts","images.ts","ignoredfields.ts","share.ts","dragAndDrop.ts","lzma.ts","export.ts","db.ts","components/AssetList.tsx","App.tsx","index.tsx"],"names":["Alert","evt","stopPropagation","preventDefault","this","props","visible","title","text","icon","options","className","onClick","onAlertClick","children","map","el","i","key","style","React","Component","Asset","renameInput","onBlur","e","onRename","target","value","setState","renaming","onDoubleClick","handleInputRef","state","focus","prevProps","prevState","info","selected","jres","onDelete","name","src","previewURI","alt","browserDownloadUInt8Array","buf","contentType","userContextWindow","onError","browserDownloadBase64","btoa","uint8ArrayToString","browserDownloadText","filename","browserDownloadDataUri","toDownloadDataUri","uri","navigator","test","userAgent","ia","stringToUint8Array","atob","split","blob","Blob","type","window","msSaveOrOpenBlob","link","document","createElement","download","href","body","appendChild","click","removeChild","location","b64","saveBlob","dataurl","b","protocol","input","len","length","res","Uint8Array","charCodeAt","String","fromCharCode","unicodeES5IdentifierStart","unicodeES5IdentifierPart","reservedWords","escapeIdentifier","char","n","trim","replace","a","lookupInUnicodeMap","indexOf","charAt","code","mid","lo","hi","getJRESImageFromDataString","data","palette","qname","tilemapTile","sourceFile","getJRESImage","jresDataToBitmap","getJRESImageFromImageLiteral","literal","defaultPattern","rows","sprite","spriteWidth","r","row","rowValues","c","push","Math","max","spriteHeight","result","Bitmap","set","imageLiteralToBitmap","undefined","bitmap","width","height","base64EncodeBitmap","bitmapToImageURI","qualifiedName","imgEncodeJRESImage","image","fileType","hexChars","get","bitmapToImageLiteral","f4EncodeImgCore","w","h","bpp","getPix","hex2","ptr","curr","shift","pushBits","j","toString","slice","hex","x","y","Uint8ClampedArray","parseInt","hexToUint8Array","x0","y0","dataLength","col","index","coordToIndex","setCore","getCore","cell","floor","ceil","jresURL","magic","out","mask","v","frame","colors","canvas","context","getContext","color","fillStyle","fillRect","toDataURL","ignoredValues","backendEndpoint","arcadePalette","fetchMakeCodeScriptAsync","url","scriptID","substr","lastIndexOf","httpGetJSONAsync","meta","filesystem","config","paletteIsCustom","parsedConfig","JSON","parse","Array","isArray","projectImages","grabImagesFromProject","files","grabTextFromProject","customPalette","parseProject","blocks","strings","variableNames","assetNames","literalRegex","numbersymbol","forEach","startsWith","xml","DOMParser","parseFromString","fields","getElementsByTagName","console","log","item","getAttribute","content","textContent","match","exec","comments","other","dedupe","s","typescriptFiles","Object","keys","filter","endsWith","fileText","grabImagesFromJRES","grabImagesFromTypeScript","seenImages","existing","jresText","metaEntry","metaMime","mimeType","metaNamespace","namespace","id","entry","Promise","resolve","reject","request","XMLHttpRequest","addEventListener","err","responseText","open","send","fileReadAsBufferAsync","f","reader","FileReader","onerror","ev","onload","readAsArrayBuffer","decodePNG","file","buffer","decodeBlobAsync","dataURL","decode","trg","acc","d","loadCanvasAsync","ctx","imgdat","getImageData","Error","hd","imageHeaderSize","dhd","decodeU32LE","imageMagic","addedLines","origSize","tmp","added","img","crossOrigin","loadImageAsync","then","drawImage","read32","pos","lzmaDecompressAsync","lzma","LZMA","decompress","error","TEST_SCRIPT","createProjectBlobAsync","assetTS","assetJRES","testTS","stringify","project","cloudId","targetVersions","editor","source","compress","lzmaCompressAsync","assets","escapeName","escaped","takenNames","projectNamespace","qualifiedNames","asset","identifier","join","_db","openPromise","initDBAsync","indexedDB","event","onupgradeneeded","objectStore","createObjectStore","keyPath","createIndex","unique","onsuccess","lookupEntryAsync","str","db","transaction","addEntryAsync","approved","add","time","Date","now","isStringApprovedAsync","markStringApprovedAsync","DEFAULT_JRES","AssetList","_items","_importInputRef","_exportInputRef","_dragInit","handleMessage","msg","loadJres","jresImage","message","saving","items","autosaveJres","getJres","setTimeout","postMessage","onAssetClick","onAssetRename","renameAsset","onAssetDelete","alert","deleteAsset","hideAlert","onAddButtonClick","addAsset","onDeleteButtonClick","backgroundColor","clearAssets","onPaste","importAssets","clipboardData","getData","onImportButtonClick","onImportDragEnter","dragging","onImportDragLeave","onExportButtonClick","downloadProjectAsync","downloadTypeScriptAsync","handleImportInputRef","handleExportInputRef","handleDropRef","dragged","idx","ext","toLowerCase","importBuffer","getAsFile","dataTransfer","types","found","dropEffect","removeEventListener","localStorage","setItem","getValidAssetName","newName","importAssetsCore","scriptId","scriptTarget","runUrl","cvsHatesThisScript","isdeleted","ignoredFiles","priorities","sort","unapprovedText","textItems","isDeleted","findIndex","getAssetIndex","parsed","strs","onClose","ref","onDragEnter","onDragLeave","placeholder","approveAllImagesAsync","approveAllStringsAsync","sandbox","App","ReactDOM","render","StrictMode","getElementById"],"mappings":";8VAkBaA,G,MAAb,kKACI,SAAaC,GACTA,EAAIC,kBACJD,EAAIE,mBAHZ,oBAMI,WACI,IAAKC,KAAKC,MAAMC,QAAS,OAAO,8BAEhC,MAAuCF,KAAKC,MAApCE,EAAR,EAAQA,MAAOC,EAAf,EAAeA,KAAMC,EAArB,EAAqBA,KAAMC,EAA3B,EAA2BA,QAC3B,OAAO,yBAAKC,UAAU,mBAClB,yBAAKA,UAAU,QAAQC,QAASR,KAAKS,cACjC,yBAAKF,UAAU,eACVF,GAAQ,uBAAGE,UAAS,0BAAqBF,KAC1C,8BAAOF,IAEX,yBAAKI,UAAU,cAAcH,GAC5BJ,KAAKC,MAAMS,UAAYV,KAAKC,MAAMS,SAClCJ,GAAW,yBAAKC,UAAU,iBACtBD,EAAQK,KAAI,SAACC,EAAIC,GACd,OAAO,yBAAKC,IAAKD,EAAGL,QAASI,EAAGJ,QAASO,MAAOH,EAAGG,OAAQH,EAAGR,gBApBtF,GAA2BY,IAAMC,YCGpBC,G,MAAb,kDAEI,WAAYjB,GAAoB,IAAD,8BAC3B,cAAMA,IAFFkB,iBACuB,IAe/BC,OAAS,SAACC,GACF,EAAKpB,MAAMqB,UAAU,EAAKrB,MAAMqB,SAASD,EAAEE,OAAOC,OACtD,EAAKC,SAAS,CAAEC,UAAU,KAjBC,EAoB/BC,cAAgB,SAACN,GACb,EAAKI,SAAS,CAAEC,UAAU,KArBC,EAwB/BE,eAAiB,SAACP,GACd,EAAKF,YAAcE,GAvBnB,EAAKQ,MAAQ,CAAEH,UAAU,GAFE,EAFnC,qDAOI,WACQ1B,KAAKmB,aAAanB,KAAKmB,YAAYW,UAR/C,gCAWI,SAAmBC,EAAuBC,GAClChC,KAAK6B,MAAMH,WAAaM,EAAUN,UAClC1B,KAAKmB,YAAYW,UAb7B,oBA8BI,WACI,MAA8C9B,KAAKC,MAA3CgC,EAAR,EAAQA,KAAMC,EAAd,EAAcA,SAAU1B,EAAxB,EAAwBA,QACV2B,GADd,EAAiCC,SACVH,EAAfI,KAAeJ,EAATE,MAEd,OAAO,yBAAK5B,UAAS,gBAAW2B,EAAW,WAAa,IAAM1B,QAASA,GACnE,yBAAKD,UAAU,aACX,yBAAK+B,IAAKH,EAAKI,WAAYC,IAAI,2BApC/C,GAA2BxB,IAAMC,YCf1B,SAASwB,EAA0BC,EAAiBL,GAAmI,IAArHM,EAAoH,uDAA9F,2BAA4BC,EAAkE,uCAAtCC,EAAsC,uCACzL,OAAOC,EAAsBC,KAAKC,EAAmBN,IAAOL,EAAMM,EAAaC,EAAmBC,GAG/F,SAASI,EAAoB7C,EAAc8C,GAE9CC,EAAuBC,EADPL,KAAK3C,GAC6B,cAAe8C,GAW9D,SAASC,EAAuBE,EAAahB,GAChD,GARSiB,WAAa,QAAQC,KAAKD,UAAUE,YAIpCF,WAAa,WAAWC,KAAKD,UAAUE,WAIxB,CAEpB,IACIC,EAAKC,EADQC,KAAKN,EAAIO,MAAM,KAAK,KAEjCC,EAAO,IAAIC,KAAK,CAACL,GAAK,CAAEM,KAAM,YACjCC,OAAOV,UAAkBW,iBAAiBJ,EAAMxB,OAC9C,CACH,IAAI6B,EAAYF,OAAOG,SAASC,cAAc,KAClB,iBAAjBF,EAAKG,UACZH,EAAKI,KAAOjB,EACZa,EAAKG,SAAWhC,EAChB8B,SAASI,KAAKC,YAAYN,GAC1BA,EAAKO,QACLN,SAASI,KAAKG,YAAYR,IAE1BC,SAASQ,SAASL,KAAOjB,GAK9B,SAASP,EAAsB8B,EAAavC,GAAmI,IAArHM,EAAoH,uDAA9F,2BAAwDE,EAAsC,uCAC3KgC,EAAiBb,OAAQV,UAAUW,iBACnCa,EAAU1B,EAAkBwB,EAAKvC,GACvC,IACI,GAAIwC,EACA,KAAME,EAAI,IAAIjB,KAAK,CAACJ,EAAmBC,KAAKiB,KAAQ,CAAEb,KAAMpB,IACvCqB,OAAQV,UAAUW,iBAAiBc,EAAG1C,QACxDc,EAAuB2B,EAASzC,GACzC,MAAOhB,GACDwB,GAASA,EAAQxB,GAEzB,OAAOyD,EAGJ,SAAS1B,EAAkBwB,EAAajC,GAG3C,MADgBqC,QAAiBrC,EAAc,WAAaiC,EAKzD,SAASlB,EAAmBuB,GAG/B,IAFA,IAAIC,EAAMD,EAAME,OACZC,EAAM,IAAIC,WAAWH,GAChBrE,EAAI,EAAGA,EAAIqE,IAAOrE,EACvBuE,EAAIvE,GAA2B,IAAtBoE,EAAMK,WAAWzE,GAC9B,OAAOuE,EAUJ,SAASpC,EAAmBiC,GAG/B,IAFA,IAAIC,EAAMD,EAAME,OACZC,EAAM,GACDvE,EAAI,EAAGA,EAAIqE,IAAOrE,EACvBuE,GAAOG,OAAOC,aAAaP,EAAMpE,IACrC,OAAOuE,EAIX,IAAMK,EAA4B,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,KAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OACniJC,EAA2B,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,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","file":"static/js/main.3bd40b49.chunk.js","sourcesContent":["import React from 'react';\nimport '../styles/Alert.css';\n\ninterface AlertOption {\n    text: string;\n    onClick: () => void;\n    style?: { [key: string]: string };\n}\n\nexport interface AlertProps {\n    title: string;\n    text: string;\n    icon?: string;\n    options?: AlertOption[];\n    visible?: boolean;\n    onClose?: () => void;\n}\n\nexport class Alert extends React.Component<AlertProps, {}> {\n    onAlertClick(evt: any) {\n        evt.stopPropagation();\n        evt.preventDefault();\n    }\n\n    render() {\n        if (!this.props.visible) return <div />;\n\n        const { title, text, icon, options } = this.props;\n        return <div className=\"alert-container\">\n            <div className=\"alert\" onClick={this.onAlertClick}>\n                <div className=\"alert-title\">\n                    {icon && <i className={`alert-icon icon ${icon}`}></i>}\n                    <span>{title}</span>\n                </div>\n                <div className=\"alert-text\">{text}</div>\n                {this.props.children && this.props.children}\n                {options && <div className=\"alert-options\">\n                    {options.map((el, i) => {\n                        return <div key={i} onClick={el.onClick} style={el.style}>{el.text}</div>\n                    })}\n                </div>}\n            </div>\n        </div>\n    }\n}","import React from 'react';\nimport { JRESImage } from '../images';\nimport '../styles/Asset.css';\n\nexport interface AssetInfo {\n    name: string;\n    jres: JRESImage;\n}\n\ninterface AssetProps {\n    info: AssetInfo;\n    selected: boolean;\n    onClick?: (e: any) => void;\n    onRename?: (name: string) => void;\n    onDelete?: (e: any) => void;\n}\n\ninterface AssetState {\n    renaming?: boolean;\n}\n\nexport class Asset extends React.Component<AssetProps, AssetState> {\n    private renameInput!: HTMLInputElement;\n    constructor(props: AssetProps) {\n        super(props);\n        this.state = { renaming: true }\n    }\n\n    componentDidMount() {\n        if (this.renameInput) this.renameInput.focus();\n    }\n\n    componentDidUpdate(prevProps: AssetProps, prevState: AssetState) {\n        if (this.state.renaming && !prevState.renaming) {\n            this.renameInput.focus();\n        }\n    }\n\n    onBlur = (e: any) => {\n        if (this.props.onRename) this.props.onRename(e.target.value);\n        this.setState({ renaming: false });\n    }\n\n    onDoubleClick = (e: any) => {\n        this.setState({ renaming: true });\n    }\n\n    handleInputRef = (e: HTMLInputElement) => {\n        this.renameInput = e;\n    }\n\n    render() {\n        const { info, selected, onClick, onDelete } = this.props;\n        const { name, jres } = info;\n\n        return <div className={`asset ${selected ? \"selected\" : \"\"}`} onClick={onClick}>\n            <div className=\"asset-img\">\n                <img src={jres.previewURI} alt=\"Preview of asset\" />\n            </div>\n        </div>\n    }\n}","/**\n * This file contains util functions taken directly from pxt-core and lightly modified\n */\n\nexport const IMAGE_MIME_TYPE = \"image/x-mkcd-f4\"\n\nexport function browserDownloadUInt8Array(buf: Uint8Array, name: string, contentType: string = \"application/octet-stream\", userContextWindow?: Window, onError?: (err: any) => void): string {\n    return browserDownloadBase64(btoa(uint8ArrayToString(buf)), name, contentType, userContextWindow, onError)\n}\n\nexport function browserDownloadText(text: string, filename: string) {\n    const encoded = btoa(text);\n    browserDownloadDataUri(toDownloadDataUri(encoded, \"text/plain\"), filename)\n}\n\nexport function isEdge(): boolean {\n    return !!navigator && /Edge/i.test(navigator.userAgent);\n}\n\nexport function isIE(): boolean {\n    return !!navigator && /Trident/i.test(navigator.userAgent);\n}\n\nexport function browserDownloadDataUri(uri: string, name: string) {\n    if (isEdge() || isIE()) {\n        //Fix for edge\n        let byteString = atob(uri.split(',')[1]);\n        let ia = stringToUint8Array(byteString);\n        let blob = new Blob([ia], { type: \"img/png\" });\n        (window.navigator as any).msSaveOrOpenBlob(blob, name);\n    } else {\n        let link = <any>window.document.createElement('a');\n        if (typeof link.download == \"string\") {\n            link.href = uri;\n            link.download = name;\n            document.body.appendChild(link); // for FF\n            link.click();\n            document.body.removeChild(link);\n        } else {\n            document.location.href = uri;\n        }\n    }\n}\n\nexport function browserDownloadBase64(b64: string, name: string, contentType: string = \"application/octet-stream\", userContextWindow?: Window, onError?: (err: any) => void): string {\n    const saveBlob = (<any>window).navigator.msSaveOrOpenBlob;\n    const dataurl = toDownloadDataUri(b64, name);\n    try {\n        if (saveBlob) {\n            const b = new Blob([stringToUint8Array(atob(b64))], { type: contentType })\n            const result = (<any>window).navigator.msSaveOrOpenBlob(b, name);\n        } else browserDownloadDataUri(dataurl, name);\n    } catch (e) {\n        if (onError) onError(e);\n    }\n    return dataurl;\n}\n\nexport function toDownloadDataUri(b64: string, contentType: string): string {\n    let protocol = \"data\";\n    const dataurl = protocol + \":\" + contentType + \";base64,\" + b64\n    return dataurl;\n}\n\n// this will take lower 8 bits from each character\nexport function stringToUint8Array(input: string) {\n    let len = input.length;\n    let res = new Uint8Array(len)\n    for (let i = 0; i < len; ++i)\n        res[i] = input.charCodeAt(i) & 0xff;\n    return res;\n}\n\nexport function hexToUint8Array(hex: string) {\n    let r = new Uint8ClampedArray(hex.length >> 1);\n    for (let i = 0; i < hex.length; i += 2)\n        r[i >> 1] = parseInt(hex.slice(i, i + 2), 16)\n    return r\n}\n\nexport function uint8ArrayToString(input: ArrayLike<number>) {\n    let len = input.length;\n    let res = \"\"\n    for (let i = 0; i < len; ++i)\n        res += String.fromCharCode(input[i]);\n    return res;\n}\n\n\nconst unicodeES5IdentifierStart = [170, 170, 181, 181, 186, 186, 192, 214, 216, 246, 248, 705, 710, 721, 736, 740, 748, 748, 750, 750, 880, 884, 886, 887, 890, 893, 902, 902, 904, 906, 908, 908, 910, 929, 931, 1013, 1015, 1153, 1162, 1319, 1329, 1366, 1369, 1369, 1377, 1415, 1488, 1514, 1520, 1522, 1568, 1610, 1646, 1647, 1649, 1747, 1749, 1749, 1765, 1766, 1774, 1775, 1786, 1788, 1791, 1791, 1808, 1808, 1810, 1839, 1869, 1957, 1969, 1969, 1994, 2026, 2036, 2037, 2042, 2042, 2048, 2069, 2074, 2074, 2084, 2084, 2088, 2088, 2112, 2136, 2208, 2208, 2210, 2220, 2308, 2361, 2365, 2365, 2384, 2384, 2392, 2401, 2417, 2423, 2425, 2431, 2437, 2444, 2447, 2448, 2451, 2472, 2474, 2480, 2482, 2482, 2486, 2489, 2493, 2493, 2510, 2510, 2524, 2525, 2527, 2529, 2544, 2545, 2565, 2570, 2575, 2576, 2579, 2600, 2602, 2608, 2610, 2611, 2613, 2614, 2616, 2617, 2649, 2652, 2654, 2654, 2674, 2676, 2693, 2701, 2703, 2705, 2707, 2728, 2730, 2736, 2738, 2739, 2741, 2745, 2749, 2749, 2768, 2768, 2784, 2785, 2821, 2828, 2831, 2832, 2835, 2856, 2858, 2864, 2866, 2867, 2869, 2873, 2877, 2877, 2908, 2909, 2911, 2913, 2929, 2929, 2947, 2947, 2949, 2954, 2958, 2960, 2962, 2965, 2969, 2970, 2972, 2972, 2974, 2975, 2979, 2980, 2984, 2986, 2990, 3001, 3024, 3024, 3077, 3084, 3086, 3088, 3090, 3112, 3114, 3123, 3125, 3129, 3133, 3133, 3160, 3161, 3168, 3169, 3205, 3212, 3214, 3216, 3218, 3240, 3242, 3251, 3253, 3257, 3261, 3261, 3294, 3294, 3296, 3297, 3313, 3314, 3333, 3340, 3342, 3344, 3346, 3386, 3389, 3389, 3406, 3406, 3424, 3425, 3450, 3455, 3461, 3478, 3482, 3505, 3507, 3515, 3517, 3517, 3520, 3526, 3585, 3632, 3634, 3635, 3648, 3654, 3713, 3714, 3716, 3716, 3719, 3720, 3722, 3722, 3725, 3725, 3732, 3735, 3737, 3743, 3745, 3747, 3749, 3749, 3751, 3751, 3754, 3755, 3757, 3760, 3762, 3763, 3773, 3773, 3776, 3780, 3782, 3782, 3804, 3807, 3840, 3840, 3904, 3911, 3913, 3948, 3976, 3980, 4096, 4138, 4159, 4159, 4176, 4181, 4186, 4189, 4193, 4193, 4197, 4198, 4206, 4208, 4213, 4225, 4238, 4238, 4256, 4293, 4295, 4295, 4301, 4301, 4304, 4346, 4348, 4680, 4682, 4685, 4688, 4694, 4696, 4696, 4698, 4701, 4704, 4744, 4746, 4749, 4752, 4784, 4786, 4789, 4792, 4798, 4800, 4800, 4802, 4805, 4808, 4822, 4824, 4880, 4882, 4885, 4888, 4954, 4992, 5007, 5024, 5108, 5121, 5740, 5743, 5759, 5761, 5786, 5792, 5866, 5870, 5872, 5888, 5900, 5902, 5905, 5920, 5937, 5952, 5969, 5984, 5996, 5998, 6000, 6016, 6067, 6103, 6103, 6108, 6108, 6176, 6263, 6272, 6312, 6314, 6314, 6320, 6389, 6400, 6428, 6480, 6509, 6512, 6516, 6528, 6571, 6593, 6599, 6656, 6678, 6688, 6740, 6823, 6823, 6917, 6963, 6981, 6987, 7043, 7072, 7086, 7087, 7098, 7141, 7168, 7203, 7245, 7247, 7258, 7293, 7401, 7404, 7406, 7409, 7413, 7414, 7424, 7615, 7680, 7957, 7960, 7965, 7968, 8005, 8008, 8013, 8016, 8023, 8025, 8025, 8027, 8027, 8029, 8029, 8031, 8061, 8064, 8116, 8118, 8124, 8126, 8126, 8130, 8132, 8134, 8140, 8144, 8147, 8150, 8155, 8160, 8172, 8178, 8180, 8182, 8188, 8305, 8305, 8319, 8319, 8336, 8348, 8450, 8450, 8455, 8455, 8458, 8467, 8469, 8469, 8473, 8477, 8484, 8484, 8486, 8486, 8488, 8488, 8490, 8493, 8495, 8505, 8508, 8511, 8517, 8521, 8526, 8526, 8544, 8584, 11264, 11310, 11312, 11358, 11360, 11492, 11499, 11502, 11506, 11507, 11520, 11557, 11559, 11559, 11565, 11565, 11568, 11623, 11631, 11631, 11648, 11670, 11680, 11686, 11688, 11694, 11696, 11702, 11704, 11710, 11712, 11718, 11720, 11726, 11728, 11734, 11736, 11742, 11823, 11823, 12293, 12295, 12321, 12329, 12337, 12341, 12344, 12348, 12353, 12438, 12445, 12447, 12449, 12538, 12540, 12543, 12549, 12589, 12593, 12686, 12704, 12730, 12784, 12799, 13312, 19893, 19968, 40908, 40960, 42124, 42192, 42237, 42240, 42508, 42512, 42527, 42538, 42539, 42560, 42606, 42623, 42647, 42656, 42735, 42775, 42783, 42786, 42888, 42891, 42894, 42896, 42899, 42912, 42922, 43000, 43009, 43011, 43013, 43015, 43018, 43020, 43042, 43072, 43123, 43138, 43187, 43250, 43255, 43259, 43259, 43274, 43301, 43312, 43334, 43360, 43388, 43396, 43442, 43471, 43471, 43520, 43560, 43584, 43586, 43588, 43595, 43616, 43638, 43642, 43642, 43648, 43695, 43697, 43697, 43701, 43702, 43705, 43709, 43712, 43712, 43714, 43714, 43739, 43741, 43744, 43754, 43762, 43764, 43777, 43782, 43785, 43790, 43793, 43798, 43808, 43814, 43816, 43822, 43968, 44002, 44032, 55203, 55216, 55238, 55243, 55291, 63744, 64109, 64112, 64217, 64256, 64262, 64275, 64279, 64285, 64285, 64287, 64296, 64298, 64310, 64312, 64316, 64318, 64318, 64320, 64321, 64323, 64324, 64326, 64433, 64467, 64829, 64848, 64911, 64914, 64967, 65008, 65019, 65136, 65140, 65142, 65276, 65313, 65338, 65345, 65370, 65382, 65470, 65474, 65479, 65482, 65487, 65490, 65495, 65498, 65500,];\nconst unicodeES5IdentifierPart = [170, 170, 181, 181, 186, 186, 192, 214, 216, 246, 248, 705, 710, 721, 736, 740, 748, 748, 750, 750, 768, 884, 886, 887, 890, 893, 902, 902, 904, 906, 908, 908, 910, 929, 931, 1013, 1015, 1153, 1155, 1159, 1162, 1319, 1329, 1366, 1369, 1369, 1377, 1415, 1425, 1469, 1471, 1471, 1473, 1474, 1476, 1477, 1479, 1479, 1488, 1514, 1520, 1522, 1552, 1562, 1568, 1641, 1646, 1747, 1749, 1756, 1759, 1768, 1770, 1788, 1791, 1791, 1808, 1866, 1869, 1969, 1984, 2037, 2042, 2042, 2048, 2093, 2112, 2139, 2208, 2208, 2210, 2220, 2276, 2302, 2304, 2403, 2406, 2415, 2417, 2423, 2425, 2431, 2433, 2435, 2437, 2444, 2447, 2448, 2451, 2472, 2474, 2480, 2482, 2482, 2486, 2489, 2492, 2500, 2503, 2504, 2507, 2510, 2519, 2519, 2524, 2525, 2527, 2531, 2534, 2545, 2561, 2563, 2565, 2570, 2575, 2576, 2579, 2600, 2602, 2608, 2610, 2611, 2613, 2614, 2616, 2617, 2620, 2620, 2622, 2626, 2631, 2632, 2635, 2637, 2641, 2641, 2649, 2652, 2654, 2654, 2662, 2677, 2689, 2691, 2693, 2701, 2703, 2705, 2707, 2728, 2730, 2736, 2738, 2739, 2741, 2745, 2748, 2757, 2759, 2761, 2763, 2765, 2768, 2768, 2784, 2787, 2790, 2799, 2817, 2819, 2821, 2828, 2831, 2832, 2835, 2856, 2858, 2864, 2866, 2867, 2869, 2873, 2876, 2884, 2887, 2888, 2891, 2893, 2902, 2903, 2908, 2909, 2911, 2915, 2918, 2927, 2929, 2929, 2946, 2947, 2949, 2954, 2958, 2960, 2962, 2965, 2969, 2970, 2972, 2972, 2974, 2975, 2979, 2980, 2984, 2986, 2990, 3001, 3006, 3010, 3014, 3016, 3018, 3021, 3024, 3024, 3031, 3031, 3046, 3055, 3073, 3075, 3077, 3084, 3086, 3088, 3090, 3112, 3114, 3123, 3125, 3129, 3133, 3140, 3142, 3144, 3146, 3149, 3157, 3158, 3160, 3161, 3168, 3171, 3174, 3183, 3202, 3203, 3205, 3212, 3214, 3216, 3218, 3240, 3242, 3251, 3253, 3257, 3260, 3268, 3270, 3272, 3274, 3277, 3285, 3286, 3294, 3294, 3296, 3299, 3302, 3311, 3313, 3314, 3330, 3331, 3333, 3340, 3342, 3344, 3346, 3386, 3389, 3396, 3398, 3400, 3402, 3406, 3415, 3415, 3424, 3427, 3430, 3439, 3450, 3455, 3458, 3459, 3461, 3478, 3482, 3505, 3507, 3515, 3517, 3517, 3520, 3526, 3530, 3530, 3535, 3540, 3542, 3542, 3544, 3551, 3570, 3571, 3585, 3642, 3648, 3662, 3664, 3673, 3713, 3714, 3716, 3716, 3719, 3720, 3722, 3722, 3725, 3725, 3732, 3735, 3737, 3743, 3745, 3747, 3749, 3749, 3751, 3751, 3754, 3755, 3757, 3769, 3771, 3773, 3776, 3780, 3782, 3782, 3784, 3789, 3792, 3801, 3804, 3807, 3840, 3840, 3864, 3865, 3872, 3881, 3893, 3893, 3895, 3895, 3897, 3897, 3902, 3911, 3913, 3948, 3953, 3972, 3974, 3991, 3993, 4028, 4038, 4038, 4096, 4169, 4176, 4253, 4256, 4293, 4295, 4295, 4301, 4301, 4304, 4346, 4348, 4680, 4682, 4685, 4688, 4694, 4696, 4696, 4698, 4701, 4704, 4744, 4746, 4749, 4752, 4784, 4786, 4789, 4792, 4798, 4800, 4800, 4802, 4805, 4808, 4822, 4824, 4880, 4882, 4885, 4888, 4954, 4957, 4959, 4992, 5007, 5024, 5108, 5121, 5740, 5743, 5759, 5761, 5786, 5792, 5866, 5870, 5872, 5888, 5900, 5902, 5908, 5920, 5940, 5952, 5971, 5984, 5996, 5998, 6000, 6002, 6003, 6016, 6099, 6103, 6103, 6108, 6109, 6112, 6121, 6155, 6157, 6160, 6169, 6176, 6263, 6272, 6314, 6320, 6389, 6400, 6428, 6432, 6443, 6448, 6459, 6470, 6509, 6512, 6516, 6528, 6571, 6576, 6601, 6608, 6617, 6656, 6683, 6688, 6750, 6752, 6780, 6783, 6793, 6800, 6809, 6823, 6823, 6912, 6987, 6992, 7001, 7019, 7027, 7040, 7155, 7168, 7223, 7232, 7241, 7245, 7293, 7376, 7378, 7380, 7414, 7424, 7654, 7676, 7957, 7960, 7965, 7968, 8005, 8008, 8013, 8016, 8023, 8025, 8025, 8027, 8027, 8029, 8029, 8031, 8061, 8064, 8116, 8118, 8124, 8126, 8126, 8130, 8132, 8134, 8140, 8144, 8147, 8150, 8155, 8160, 8172, 8178, 8180, 8182, 8188, 8204, 8205, 8255, 8256, 8276, 8276, 8305, 8305, 8319, 8319, 8336, 8348, 8400, 8412, 8417, 8417, 8421, 8432, 8450, 8450, 8455, 8455, 8458, 8467, 8469, 8469, 8473, 8477, 8484, 8484, 8486, 8486, 8488, 8488, 8490, 8493, 8495, 8505, 8508, 8511, 8517, 8521, 8526, 8526, 8544, 8584, 11264, 11310, 11312, 11358, 11360, 11492, 11499, 11507, 11520, 11557, 11559, 11559, 11565, 11565, 11568, 11623, 11631, 11631, 11647, 11670, 11680, 11686, 11688, 11694, 11696, 11702, 11704, 11710, 11712, 11718, 11720, 11726, 11728, 11734, 11736, 11742, 11744, 11775, 11823, 11823, 12293, 12295, 12321, 12335, 12337, 12341, 12344, 12348, 12353, 12438, 12441, 12442, 12445, 12447, 12449, 12538, 12540, 12543, 12549, 12589, 12593, 12686, 12704, 12730, 12784, 12799, 13312, 19893, 19968, 40908, 40960, 42124, 42192, 42237, 42240, 42508, 42512, 42539, 42560, 42607, 42612, 42621, 42623, 42647, 42655, 42737, 42775, 42783, 42786, 42888, 42891, 42894, 42896, 42899, 42912, 42922, 43000, 43047, 43072, 43123, 43136, 43204, 43216, 43225, 43232, 43255, 43259, 43259, 43264, 43309, 43312, 43347, 43360, 43388, 43392, 43456, 43471, 43481, 43520, 43574, 43584, 43597, 43600, 43609, 43616, 43638, 43642, 43643, 43648, 43714, 43739, 43741, 43744, 43759, 43762, 43766, 43777, 43782, 43785, 43790, 43793, 43798, 43808, 43814, 43816, 43822, 43968, 44010, 44012, 44013, 44016, 44025, 44032, 55203, 55216, 55238, 55243, 55291, 63744, 64109, 64112, 64217, 64256, 64262, 64275, 64279, 64285, 64296, 64298, 64310, 64312, 64316, 64318, 64318, 64320, 64321, 64323, 64324, 64326, 64433, 64467, 64829, 64848, 64911, 64914, 64967, 65008, 65019, 65024, 65039, 65056, 65062, 65075, 65076, 65101, 65103, 65136, 65140, 65142, 65276, 65296, 65305, 65313, 65338, 65343, 65343, 65345, 65370, 65382, 65470, 65474, 65479, 65482, 65487, 65490, 65495, 65498, 65500,];\nconst reservedWords = [\"abstract\", \"any\", \"as\", \"break\",\n    \"case\", \"catch\", \"class\", \"continue\", \"const\", \"constructor\", \"debugger\",\n    \"declare\", \"default\", \"delete\", \"do\", \"else\", \"enum\", \"export\", \"extends\",\n    \"false\", \"finally\", \"for\", \"from\", \"function\", \"get\", \"if\", \"implements\",\n    \"import\", \"in\", \"instanceof\", \"interface\", \"is\", \"let\", \"module\", \"namespace\",\n    \"new\", \"null\", \"package\", \"private\", \"protected\", \"public\",\n    \"require\", \"global\", \"return\", \"set\", \"static\", \"super\", \"switch\",\n    \"symbol\", \"this\", \"throw\", \"true\", \"try\", \"type\", \"typeof\", \"var\", \"void\",\n    \"while\", \"with\", \"yield\", \"async\", \"await\", \"of\", \"Math\"];\n\n\nexport function escapeIdentifier(name: string): string {\n    if (!name) return '_';\n\n    let n = name.trim().replace(/\\s+/g, \"_\").replace(/[^a-zA-Z0-9_$]/g, a =>\n        isIdentifierPart(a.charCodeAt(0)) ? a : \"\");\n\n    if (n.length === 0 || reservedWords.indexOf(n) !== -1 || !isIdentifierStart(n.charAt(0))) {\n        n = \"_\" + n;\n    }\n\n    return n;\n}\n\nfunction isIdentifierPart(charCode: number) {\n    return lookupInUnicodeMap(charCode, unicodeES5IdentifierPart);\n}\n\nfunction isIdentifierStart(char: string) {\n    if (/[a-zA-Z_$]/.test(char)) return true;\n    return lookupInUnicodeMap(char.charCodeAt(0), unicodeES5IdentifierStart);\n}\n\nfunction lookupInUnicodeMap(code: number, map: number[]): boolean {\n    // Bail out quickly if it couldn't possibly be in the map.\n    if (code < map[0]) {\n        return false;\n    }\n\n    // Perform binary search in one of the Unicode range maps\n    let lo = 0;\n    let hi: number = map.length;\n    let mid: number;\n\n    while (lo + 1 < hi) {\n        mid = lo + (hi - lo) / 2;\n        // mid has to be even to catch a range's beginning\n        mid -= mid % 2;\n        if (map[mid] <= code && code <= map[mid + 1]) {\n            return true;\n        }\n\n        if (code < map[mid]) {\n            hi = mid;\n        }\n        else {\n            lo = mid + 2;\n        }\n    }\n\n    return false;\n}\n","import { uint8ArrayToString, hexToUint8Array } from \"./util\";\n\nexport interface JRESImage {\n    data: string; // Base64 encoded string of f4 encoded bytes\n    previewURI: string; // PNG data uri\n    width: number;\n    height: number;\n\n    qualifiedName?: string;\n    tilemapTile?: boolean;\n    sourceFile?: string;\n}\n\nexport interface ImageInfo {\n    width: number;\n    height: number;\n    pixels: Uint8ClampedArray;\n}\n\nexport async function getImageFromURIAsync(uri: string): Promise<ImageInfo | null> {\n    const loaded = await loadImageAsync(uri);\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = loaded.width;\n    canvas.height = loaded.height;\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return null;\n\n    ctx.drawImage(loaded, 0, 0);\n    const data = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n    return {\n        width: data.width,\n        height: data.height,\n        pixels: data.data\n    };\n}\n\nasync function loadImageAsync(uri: string): Promise<HTMLImageElement> {\n    return new Promise<HTMLImageElement>(resolve => {\n        const el = document.createElement(\"img\");\n        el.src = uri\n        el.onload = () => {\n            resolve(el)\n        };\n    })\n}\n\nexport async function getJRESImageFromUint8Array(buf: Uint8Array, palette: string[]): Promise<JRESImage | null> {\n    const encoded = btoa(uint8ArrayToString(buf));\n    const imageInfo = await getImageFromURIAsync(\"data:image/png;base64,\" + encoded);\n    if (imageInfo) {\n        const imageLit = imgEncodeImage(imageInfo, palette);\n        return await getJRESImageFromImageLiteral(imageLit, palette);\n    }\n    return null;\n}\n\nexport function getJRESImageFromDataString(data: string, palette: string[], qname?: string, tilemapTile?: boolean, sourceFile?: string): JRESImage {\n    const bitmap = jresDataToBitmap(data);\n\n    return getJRESImage(bitmap, palette, data, qname, tilemapTile, sourceFile)\n}\n\nexport function getJRESImageFromImageLiteral(literal: string, palette: string[], sourceFile?: string) {\n    const bitmap = imageLiteralToBitmap(literal);\n    return getJRESImage(bitmap, palette, undefined, undefined, undefined, sourceFile)\n}\n\n\nfunction getJRESImage(bitmap: Bitmap, palette: string[], data?: string, qname?: string, tilemapTile?: boolean, sourceFile?: string): JRESImage {\n    return {\n        width: bitmap.width,\n        height: bitmap.height,\n        data: data || base64EncodeBitmap(bitmap),\n        previewURI: bitmapToImageURI(bitmap, palette),\n        qualifiedName: qname,\n        tilemapTile,\n        sourceFile\n    }\n}\n\nexport function imgEncodeJRESImage(image: JRESImage) {\n    const bitmap = jresDataToBitmap(image.data);\n    return bitmapToImageLiteral(bitmap, \"typescript\");\n}\n\n\nconst hexChars = [\".\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"];\n\nfunction bitmapToImageLiteral(bitmap: Bitmap, fileType: \"typescript\" | \"python\"): string {\n    let res = '';\n    switch (fileType) {\n        case \"python\":\n            res = \"img(\\\"\\\"\\\"\";\n            break;\n        default:\n            res = \"img`\";\n            break;\n    }\n\n    if (bitmap) {\n        for (let r = 0; r < bitmap.height; r++) {\n            res += \"\\n\"\n            for (let c = 0; c < bitmap.width; c++) {\n                res += hexChars[bitmap.get(c, r)] + \" \";\n            }\n        }\n    }\n\n    res += \"\\n\";\n\n    switch (fileType) {\n        case \"python\":\n            res += \"\\\"\\\"\\\")\";\n            break;\n        default:\n            res += \"`\";\n            break;\n    }\n\n    return res;\n}\n\n\n/**\n * Encodes the image in the image/mkcd-f4 format (used for the data attribute in jres files)\n * @param image\n * @param colors\n */\nexport function f4EncodeImage(image: ImageInfo, colors: string[]) {\n    const palette = colorsToNumbers(colors);\n\n    return f4EncodeImgCore(image.width, image.height, 4, (x, y) => {\n        const index = y * image.width + x;\n        return closestColor(image.pixels, index << 2, palette);\n    });\n}\n\n/**\n * Encodes the image as an img`` literal\n * @param image\n * @param colors\n */\nexport function imgEncodeImage(image: ImageInfo, colors: string[]) {\n    const palette = colorsToNumbers(colors);\n\n    return imgEncodeImgCore(image.width, image.height, (x, y) => {\n        const index = y * image.width + x;\n        return closestColor(image.pixels, index << 2, palette);\n    });\n}\n\nfunction colorsToNumbers(colors: string[]): number[][] {\n    const res: number[][] = [];\n    for (let i = 0; i < colors.length; i++) {\n        const color = parseColorString(colors[i]);\n        res.push([_r(color), _g(color), _b(color)]);\n    }\n    return res;\n}\n\n// use geometric distance on colors\nfunction scale(v: number) {\n    return v * v\n}\n\nfunction closestColor(buf: Uint8ClampedArray, pix: number, palette: number[][], alpha = true) {\n    if (alpha && buf[pix + 3] < 100)\n        return 0 // transparent\n    let mindelta = 0\n    let idx = -1\n    for (let i = alpha ? 1 : 0; i < palette.length; ++i) {\n        let delta = scale(palette[i][0] - buf[pix + 0]) + scale(palette[i][1] - buf[pix + 1]) + scale(palette[i][2] - buf[pix + 2])\n        if (idx < 0 || delta < mindelta) {\n            idx = i\n            mindelta = delta\n        }\n    }\n    return idx\n}\n\nfunction f4EncodeImgCore(w: number, h: number, bpp: number, getPix: (x: number, y: number) => number) {\n    let r = hex2(0xe0 | bpp) + hex2(w) + hex2(h) + \"00\"\n    let ptr = 4\n    let curr = 0\n    let shift = 0\n\n    let pushBits = (n: number) => {\n        curr |= n << shift\n        // eslint-disable-next-line\n        if (shift == 8 - bpp) {\n            r += hex2(curr)\n            ptr++\n            curr = 0\n            shift = 0\n        } else {\n            shift += bpp\n        }\n    }\n\n    for (let i = 0; i < w; ++i) {\n        for (let j = 0; j < h; ++j)\n            pushBits(getPix(i, j))\n        // eslint-disable-next-line\n        while (shift != 0)\n            pushBits(0)\n        if (bpp > 1) {\n            while (ptr & 3)\n                pushBits(0)\n        }\n    }\n\n    return r\n\n    function hex2(n: number) {\n        return (\"0\" + n.toString(16)).slice(-2)\n    }\n}\n\nfunction imgEncodeImgCore(w: number, h: number, getPix: (x: number, y: number) => number) {\n    let res = \"img`\\n    \"\n    for (let r = 0; r < h; r++) {\n        let row: number[] = []\n        for (let c = 0; c < w; c++) {\n            row.push(getPix(c, r));\n        }\n        res += row.map(n => n.toString(16)).join(\" \");\n        res += \"\\n    \"\n    }\n    res += \"`\";\n    return res;\n}\n\nfunction base64EncodeBitmap(bitmap: Bitmap) {\n    const hex = f4EncodeImgCore(bitmap.width, bitmap.height, 4, (x, y) => bitmap.get(x, y));\n    return btoa(uint8ArrayToString(hexToUint8Array(hex)))\n}\n\nfunction _r(color: number) { return (color >> 16) & 0xff }\nfunction _g(color: number) { return (color >> 8) & 0xff }\nfunction _b(color: number) { return color & 0xff }\n\nfunction parseColorString(color: string) {\n    if (color) {\n        if (color.length === 6) {\n            return parseInt(\"0x\" + color);\n        }\n        else if (color.length === 7) {\n            return parseInt(\"0x\" + color.substr(1));\n        }\n    }\n    return 0;\n}\n\n/**\n * 16-color sprite\n */\nexport class Bitmap {\n    protected buf: Uint8ClampedArray;\n\n    constructor(public width: number, public height: number, public x0 = 0, public y0 = 0, buf?: Uint8ClampedArray) {\n        this.buf = buf || new Uint8ClampedArray(this.dataLength());\n    }\n\n    set(col: number, row: number, value: number) {\n        if (col < this.width && row < this.height && col >= 0 && row >= 0) {\n            const index = this.coordToIndex(col, row);\n            this.setCore(index, value);\n        }\n    }\n\n    get(col: number, row: number) {\n        if (col < this.width && row < this.height && col >= 0 && row >= 0) {\n            const index = this.coordToIndex(col, row);\n            return this.getCore(index);\n        }\n        return 0;\n    }\n\n    protected coordToIndex(col: number, row: number) {\n        return col + row * this.width;\n    }\n\n    protected getCore(index: number) {\n        const cell = Math.floor(index / 2);\n        if (index % 2 === 0) {\n            return this.buf[cell] & 0xf;\n        }\n        else {\n            return (this.buf[cell] & 0xf0) >> 4;\n        }\n    }\n\n    protected setCore(index: number, value: number) {\n        const cell = Math.floor(index / 2);\n        if (index % 2 === 0) {\n            this.buf[cell] = (this.buf[cell] & 0xf0) | (value & 0xf);\n        }\n        else {\n            this.buf[cell] = (this.buf[cell] & 0x0f) | ((value & 0xf) << 4);\n        }\n    }\n\n    protected dataLength() {\n        return Math.ceil(this.width * this.height / 2);\n    }\n}\n\n\nfunction jresDataToBitmap(jresURL: string) {\n    let data = atob(jresURL.slice(jresURL.indexOf(\",\") + 1))\n    let magic = data.charCodeAt(0);\n    let w = data.charCodeAt(1);\n    let h = data.charCodeAt(2);\n\n    if (magic === 0x87) {\n        magic = 0xe0 | data.charCodeAt(1);\n        w = data.charCodeAt(2) | (data.charCodeAt(3) << 8);\n        h = data.charCodeAt(4) | (data.charCodeAt(5) << 8);\n        data = data.slice(4);\n    }\n\n    const out = new Bitmap(w, h);\n\n    let index = 4\n    if (magic === 0xe1) {\n        // Monochrome\n        let mask = 0x01\n        let v = data.charCodeAt(index++)\n        for (let x = 0; x < w; ++x) {\n            for (let y = 0; y < h; ++y) {\n                out.set(x, y, (v & mask) ? 1 : 0);\n                mask <<= 1\n                // eslint-disable-next-line\n                if (mask == 0x100) {\n                    mask = 0x01\n                    v = data.charCodeAt(index++)\n                }\n            }\n        }\n    }\n    else {\n        // Color\n        for (let x = 0; x < w; x++) {\n            for (let y = 0; y < h; y += 2) {\n                let v = data.charCodeAt(index++)\n                out.set(x, y, v & 0xf);\n                // eslint-disable-next-line\n                if (y != h - 1) {\n                    out.set(x, y + 1, (v >> 4) & 0xf);\n                }\n            }\n            while (index & 3) index++\n        }\n    }\n\n    return out;\n}\n\nfunction imageLiteralToBitmap(text: string, defaultPattern?: string): Bitmap {\n    // Strip the tagged template string business and the whitespace. We don't have to exhaustively\n    // replace encoded characters because the compiler will catch any disallowed characters and throw\n    // an error before the decompilation happens. 96 is backtick and 9 is tab\n    text = text.replace(/[ `]|(?:&#96;)|(?:&#9;)|(?:img)/g, \"\").trim();\n    // eslint-disable-next-line\n    text = text.replace(/^[\"`\\(\\)]*/, '').replace(/[\"`\\(\\)]*$/, '');\n    text = text.replace(/&#10;/g, \"\\n\");\n\n    if (!text && defaultPattern)\n        text = defaultPattern;\n\n    const rows = text.split(\"\\n\");\n\n    // We support \"ragged\" sprites so not all rows will be the same length\n    const sprite: number[][] = [];\n    let spriteWidth = 0;\n\n    for (let r = 0; r < rows.length; r++) {\n        const row = rows[r];\n        const rowValues: number[] = [];\n        for (let c = 0; c < row.length; c++) {\n            // This list comes from libs/screen/targetOverrides.ts in pxt-arcade\n            // Technically, this could change per target.\n            switch (row[c]) {\n                case \"0\": case \".\": rowValues.push(0); break;\n                case \"1\": case \"#\": rowValues.push(1); break;\n                case \"2\": case \"T\": rowValues.push(2); break;\n                case \"3\": case \"t\": rowValues.push(3); break;\n                case \"4\": case \"N\": rowValues.push(4); break;\n                case \"5\": case \"n\": rowValues.push(5); break;\n                case \"6\": case \"G\": rowValues.push(6); break;\n                case \"7\": case \"g\": rowValues.push(7); break;\n                case \"8\": rowValues.push(8); break;\n                case \"9\": rowValues.push(9); break;\n                case \"a\": case \"A\": case \"R\": rowValues.push(10); break;\n                case \"b\": case \"B\": case \"P\": rowValues.push(11); break;\n                case \"c\": case \"C\": case \"p\": rowValues.push(12); break;\n                case \"d\": case \"D\": case \"O\": rowValues.push(13); break;\n                case \"e\": case \"E\": case \"Y\": rowValues.push(14); break;\n                case \"f\": case \"F\": case \"W\": rowValues.push(15); break;\n            }\n        }\n\n        if (rowValues.length) {\n            sprite.push(rowValues);\n            spriteWidth = Math.max(spriteWidth, rowValues.length);\n        }\n    }\n\n    const spriteHeight = sprite.length;\n\n    const result = new Bitmap(spriteWidth, spriteHeight)\n\n    for (let r = 0; r < spriteHeight; r++) {\n        const row = sprite[r];\n        for (let c = 0; c < spriteWidth; c++) {\n            if (c < row.length) {\n                result.set(c, r, row[c]);\n            }\n            else {\n                result.set(c, r, 0);\n            }\n        }\n    }\n\n    return result;\n}\n\n/**\n * Converts a bitmap into a square image suitable for display\n */\nfunction bitmapToImageURI(frame: Bitmap, colors: string[]) {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = frame.width;\n    canvas.height = frame.height;\n\n    let context = canvas.getContext(\"2d\");\n\n    if (context) {\n        for (let c = 0; c < frame.width; c++) {\n            for (let r = 0; r < frame.height; r++) {\n                const color = frame.get(c, r);\n\n                if (color) {\n                    context.fillStyle = colors[color];\n                    context.fillRect(c, r, 1, 1);\n                }\n            }\n        }\n    }\n\n\n    return canvas.toDataURL();\n}\n\n","export const ignoredValues = [\n    `\"- - - - - - - - \"`, `Projectile`, `Food`, `Enemy`, `mySprite`, `Player`, `mySprite2`, `Sprite.x`, `effects.spray`,\n    `false`, `animation.flyToCenter`, `ADD`, `min`, `max`, `round`, `ceil`, `floor`, `trunc`, `Sprite.x`, `Sprite.y`,\n    `Sprite.vx`, `MINUS`, `MULTIPLY`, `DIVIDE`, `POWER`, `sqrt`, `sin`, `cos`, `tan`, `atan2`, `idiv`, `imul`,\n    `TRUE`, `AND`, `OR`, `FALSE`, `TileDirection.Left`, `TileDirection.Bottom`, `TileDirection.Right`, `TileDirection.Top`,\n    `TileDirection.Center`, `animation.AnimationTypes.All`, `animation.AnimationTypes.ImageAnimation`,\n    `animation.AnimationTypes.MovementAnimation`, `list`, `Sprite.vy`, `Sprite.ax`, `Sprite.ay`, `Sprite.fx`, `Sprite.fy`,\n    `Sprite.lifespan`, `Sprite.width`, `Sprite.height`, `Sprite.left`, `Sprite.right`, `Sprite.top`, `Sprite.bottom`, `Sprite.z`,\n    `SpriteFlag.AutoDestroy`, `SpriteFlag.Ghost`, `SpriteFlag.StayInScreen`, `SpriteFlag.DestroyOnWall`, `SpriteFlag.BounceOnWall`,\n    `SpriteFlag.ShowPhysics`, `SpriteFlag.Invisible`, `SpriteFlag.RelativeToCamera`, `SpriteFlag.GhostThroughSprites`,\n    `SpriteFlag.GhostThroughTiles`, `SpriteFlag.GhostThroughWalls`, `controller.right`, `ControllerButtonEvent.Released`,\n    `controller.A`, `ControllerButtonEvent.Pressed`, `controller.down`, `ControllerButtonEvent.Repeated`, `controller.B`,\n    `controller.menu`, `controller.left`, `controller.anyButton`, `controller.up`, `sprite`, `sprites.castle.tileGrass2`,\n    `location`, `controller.player2`, `ControllerEvent.Disconnected`, `info.player2`, `controller.player3`, `ControllerEvent.Connected`,\n    `info.player3`, `info.player4`, `controller.player4`, `music.wawawawaa`, `music.baDing`, `music.jumpUp`, `music.jumpDown`,\n    `music.sonar`, `music.spooky`, `music.beamUp`, `music.smallCrash`, `music.bigCrash`, `music.zapped`, `music.buzzer`,\n    `music.powerUp`, `music.powerDown`, `music.magicWand`, `music.siren`, `music.pewPew`, `music.knock`, `music.footstep`,\n    `music.thump`, `controller.player1`, `info.player1`, \"EQ\", \"GT\", \"LT\", \"GTE\", \"LTE\", \"NEQ\", \"true\", \"false\",\n    \"sprites.food.bigBurger\", \"sprites.food.bigDrumstick\", \"sprites.food.bigHam\", \"sprites.food.bigPizza\", \"sprites.food.bigTaco\", \"sprites.food.bigCake\", \"sprites.food.bigDonut\", \"sprites.food.bigIceCream\", \"sprites.food.plate\", \"sprites.builtin.angelFish0\", \"sprites.builtin.angelFish1\", \"sprites.builtin.angelFish2\", \"sprites.builtin.angelFish3\", \"sprites.builtin.aquaticBackground\", \"sprites.builtin.bed0\", \"sprites.builtin.bed1\", \"sprites.builtin.bed2\", \"sprites.builtin.brick\", \"sprites.builtin.cat0\", \"sprites.builtin.cat1\", \"sprites.builtin.cat2\", \"sprites.builtin.clam0\", \"sprites.builtin.clam1\", \"sprites.builtin.clam2\", \"sprites.builtin.clownFish0\", \"sprites.builtin.clownFish1\", \"sprites.builtin.clownFish2\", \"sprites.builtin.clownFish3\", \"sprites.builtin.coin0\", \"sprites.builtin.coin1\", \"sprites.builtin.coin2\", \"sprites.builtin.coin3\", \"sprites.builtin.coin4\", \"sprites.builtin.coin5\", \"sprites.builtin.computer0\", \"sprites.builtin.computer1\", \"sprites.builtin.console\", \"sprites.builtin.coral0\", \"sprites.builtin.coral1\", \"sprites.builtin.coral2\", \"sprites.builtin.coral3\", \"sprites.builtin.coral4\", \"sprites.builtin.coral5\", \"sprites.builtin.couchFront0\", \"sprites.builtin.couchFront1\", \"sprites.builtin.couchSide0\", \"sprites.builtin.couchSide1\", \"sprites.builtin.couchSide2\", \"sprites.builtin.crowd0\", \"sprites.builtin.crowd1\", \"sprites.builtin.crowd2\", \"sprites.builtin.crowd3\", \"sprites.builtin.crowd4\", \"sprites.builtin.crowd5\", \"sprites.builtin.crowd6\", \"sprites.builtin.crowd7\", \"sprites.builtin.crowd8\", \"sprites.builtin.crowd9\", \"sprites.builtin.dog0\", \"sprites.builtin.dog1\", \"sprites.builtin.dog2\", \"sprites.builtin.field0\", \"sprites.builtin.field1\", \"sprites.builtin.fieldGoal\", \"sprites.builtin.football1\", \"sprites.builtin.football2\", \"sprites.builtin.football3\", \"sprites.builtin.football4\", \"sprites.builtin.football6\", \"sprites.builtin.football7\", \"sprites.builtin.footballPlayer0\", \"sprites.builtin.footballPlayer1\", \"sprites.builtin.footballPlayer2\", \"sprites.builtin.footballPlayer3\", \"sprites.builtin.footballPlayer4\", \"sprites.builtin.footballPlayer5\", \"sprites.builtin.footballPlayer6\", \"sprites.builtin.footballPlayer7\", \"sprites.builtin.forestBackground\", \"sprites.builtin.forestBat0\", \"sprites.builtin.forestBat1\", \"sprites.builtin.forestBat2\", \"sprites.builtin.forestBat3\", \"sprites.builtin.forestBat4\", \"sprites.builtin.forestBat5\", \"sprites.builtin.forestBat6\", \"sprites.builtin.forestBat7\", \"sprites.builtin.forestFlowers0\", \"sprites.builtin.forestFlowers1\", \"sprites.builtin.forestFlowers2\", \"sprites.builtin.forestLargeMushroom0\", \"sprites.builtin.forestLargeMushroom1\", \"sprites.builtin.forestMonkey0\", \"sprites.builtin.forestMonkey1\", \"sprites.builtin.forestMonkey2\", \"sprites.builtin.forestMonkey3\", \"sprites.builtin.forestMonkey4\", \"sprites.builtin.forestMonkey5\", \"sprites.builtin.forestMonkey6\", \"sprites.builtin.forestMonkey7\", \"sprites.builtin.forestMonkey8\", \"sprites.builtin.forestMonkey9\", \"sprites.builtin.forestMonkey10\", \"sprites.builtin.forestMushroomPatch\", \"sprites.builtin.forestScenery0\", \"sprites.builtin.forestScenery1\", \"sprites.builtin.forestScenery2\", \"sprites.builtin.forestScenery3\", \"sprites.builtin.forestSnake0\", \"sprites.builtin.forestSnake1\", \"sprites.builtin.forestSnake2\", \"sprites.builtin.forestSnake3\", \"sprites.builtin.forestSnake4\", \"sprites.builtin.forestSnake5\", \"sprites.builtin.forestSnake6\", \"sprites.builtin.forestSnake7\", \"sprites.builtin.forestTiles0\", \"sprites.builtin.forestTiles1\", \"sprites.builtin.forestTiles2\", \"sprites.builtin.forestTiles3\", \"sprites.builtin.forestTiles4\", \"sprites.builtin.forestTiles5\", \"sprites.builtin.forestTiles6\", \"sprites.builtin.forestTiles7\", \"sprites.builtin.forestTiles8\", \"sprites.builtin.forestTiles9\", \"sprites.builtin.forestTiles10\", \"sprites.builtin.forestTiles11\", \"sprites.builtin.forestTiles12\", \"sprites.builtin.forestTiles13\", \"sprites.builtin.forestTiles14\", \"sprites.builtin.forestTiles15\", \"sprites.builtin.forestTiles16\", \"sprites.builtin.forestTiles17\", \"sprites.builtin.forestTiles18\", \"sprites.builtin.forestTiles19\", \"sprites.builtin.forestTiles20\", \"sprites.builtin.forestTiles21\", \"sprites.builtin.forestTiles22\", \"sprites.builtin.forestTiles23\", \"sprites.builtin.forestTiles24\", \"sprites.builtin.forestTiles25\", \"sprites.builtin.forestTiles26\", \"sprites.builtin.forestTiles27\", \"sprites.builtin.forestTiles28\", \"sprites.builtin.forestTiles29\", \"sprites.builtin.forestTree0\", \"sprites.builtin.forestTree1\", \"sprites.builtin.forestTree2\", \"sprites.builtin.forestTree3\", \"sprites.builtin.forestTreeGroup0\", \"sprites.builtin.forestTreeGroup1\", \"sprites.builtin.forestTreeGroup2\", \"sprites.builtin.forestTreeGroup3\", \"sprites.builtin.forestTreeGroup4\", \"sprites.builtin.furnitureRug\", \"sprites.builtin.furnitureTable1\", \"sprites.builtin.furnitureTable2\", \"sprites.builtin.hermitCrabAttack0\", \"sprites.builtin.hermitCrabAttack1\", \"sprites.builtin.hermitCrabAttack2\", \"sprites.builtin.hermitCrabAttack3\", \"sprites.builtin.hermitCrabAttack4\", \"sprites.builtin.hermitCrabAttack5\", \"sprites.builtin.hermitCrabAwaken0\", \"sprites.builtin.hermitCrabAwaken1\", \"sprites.builtin.hermitCrabAwaken2\", \"sprites.builtin.hermitCrabAwaken3\", \"sprites.builtin.hermitCrabAwaken4\", \"sprites.builtin.hermitCrabAwaken5\", \"sprites.builtin.hermitCrabWalk0\", \"sprites.builtin.hermitCrabWalk1\", \"sprites.builtin.hermitCrabWalk2\", \"sprites.builtin.hermitCrabWalk3\", \"sprites.builtin.largeOceanRock\", \"sprites.builtin.largeShelf\", \"sprites.builtin.mediumOceanRock\", \"sprites.builtin.oceanDepths0\", \"sprites.builtin.oceanDepths1\", \"sprites.builtin.oceanDepths2\", \"sprites.builtin.oceanDepths3\", \"sprites.builtin.oceanDepths4\", \"sprites.builtin.oceanDepths5\", \"sprites.builtin.oceanDepths6\", \"sprites.builtin.oceanDepths7\", \"sprites.builtin.oceanDepths8\", \"sprites.builtin.oceanDepths9\", \"sprites.builtin.oceanDepths10\", \"sprites.builtin.oceanDepths11\", \"sprites.builtin.oceanSand0\", \"sprites.builtin.oceanSand1\", \"sprites.builtin.oceanSand2\", \"sprites.builtin.oceanSand3\", \"sprites.builtin.oceanSand4\", \"sprites.builtin.oceanSand5\", \"sprites.builtin.oceanSand6\", \"sprites.builtin.oceanSand7\", \"sprites.builtin.oceanSand8\", \"sprites.builtin.oceanSand9\", \"sprites.builtin.oceanSand10\", \"sprites.builtin.oceanSand11\", \"sprites.builtin.oceanSand12\", \"sprites.builtin.oceanSand13\", \"sprites.builtin.oceanSand14\", \"sprites.builtin.oceanSand15\", \"sprites.builtin.seaweed0\", \"sprites.builtin.seaweed1\", \"sprites.builtin.seaweed2\", \"sprites.builtin.shark0\", \"sprites.builtin.shark1\", \"sprites.builtin.shark2\", \"sprites.builtin.shark3\", \"sprites.builtin.sharkAttack0\", \"sprites.builtin.sharkAttack1\", \"sprites.builtin.sharkAttack2\", \"sprites.builtin.sharkAttack3\", \"sprites.builtin.sharkAttack4\", \"sprites.builtin.sharkAttack5\", \"sprites.builtin.smallOceanRock\", \"sprites.builtin.smallShelf0\", \"sprites.builtin.smallShelf1\", \"sprites.builtin.smallShelf2\", \"sprites.builtin.tv\", \"sprites.builtin.villager1WalkFront1\", \"sprites.builtin.villager1WalkFront2\", \"sprites.builtin.villager1WalkFront3\", \"sprites.builtin.villager1WalkBack1\", \"sprites.builtin.villager1WalkBack2\", \"sprites.builtin.villager1WalkBack3\", \"sprites.builtin.villager1WalkLeft1\", \"sprites.builtin.villager1WalkLeft2\", \"sprites.builtin.villager1WalkLeft3\", \"sprites.builtin.villager1WalkRight1\", \"sprites.builtin.villager1WalkRight2\", \"sprites.builtin.villager1WalkRight3\", \"sprites.builtin.villager2WalkFront1\", \"sprites.builtin.villager2WalkFront2\", \"sprites.builtin.villager2WalkFront3\", \"sprites.builtin.villager2WalkBack1\", \"sprites.builtin.villager2WalkBack2\", \"sprites.builtin.villager2WalkBack3\", \"sprites.builtin.villager2WalkLeft1\", \"sprites.builtin.villager2WalkLeft2\", \"sprites.builtin.villager2WalkLeft3\", \"sprites.builtin.villager2WalkRight1\", \"sprites.builtin.villager2WalkRight2\", \"sprites.builtin.villager2WalkRight3\", \"sprites.builtin.villager3WalkFront1\", \"sprites.builtin.villager3WalkFront2\", \"sprites.builtin.villager3WalkFront3\", \"sprites.builtin.villager3WalkBack1\", \"sprites.builtin.villager3WalkBack2\", \"sprites.builtin.villager3WalkBack3\", \"sprites.builtin.villager3WalkLeft1\", \"sprites.builtin.villager3WalkLeft2\", \"sprites.builtin.villager3WalkLeft3\", \"sprites.builtin.villager3WalkRight1\", \"sprites.builtin.villager3WalkRight2\", \"sprites.builtin.villager3WalkRight3\", \"sprites.builtin.villager4WalkFront1\", \"sprites.builtin.villager4WalkFront2\", \"sprites.builtin.villager4WalkFront3\", \"sprites.builtin.villager4WalkBack1\", \"sprites.builtin.villager4WalkBack2\", \"sprites.builtin.villager4WalkBack3\", \"sprites.builtin.villager4WalkLeft1\", \"sprites.builtin.villager4WalkLeft2\", \"sprites.builtin.villager4WalkRight1\", \"sprites.builtin.villager4WalkRight2\", \"sprites.castle.heroFrontAttack1\", \"sprites.castle.heroFrontAttack2\", \"sprites.castle.heroFrontAttack3\", \"sprites.castle.heroFrontAttack4\", \"sprites.castle.heroSideAttackLeft1\", \"sprites.castle.heroSideAttackLeft2\", \"sprites.castle.heroSideAttackLeft3\", \"sprites.castle.heroSideAttackLeft4\", \"sprites.castle.heroSideAttackRight4\", \"sprites.castle.heroSideAttackRight3\", \"sprites.castle.heroSideAttackRight2\", \"sprites.castle.heroSideAttackRight1\", \"sprites.castle.heroWalkFront1\", \"sprites.castle.heroWalkFront2\", \"sprites.castle.heroWalkFront3\", \"sprites.castle.heroWalkFront4\", \"sprites.castle.heroWalkBack1\", \"sprites.castle.heroWalkBack2\", \"sprites.castle.heroWalkBack3\", \"sprites.castle.heroWalkBack4\", \"sprites.castle.heroWalkShieldFront1\", \"sprites.castle.heroWalkShieldFront2\", \"sprites.castle.heroWalkShieldFront3\", \"sprites.castle.heroWalkShieldFront4\", \"sprites.castle.heroWalkShieldBack1\", \"sprites.castle.heroWalkShieldBack2\", \"sprites.castle.heroWalkShieldBack3\", \"sprites.castle.heroWalkShieldBack4\", \"sprites.castle.heroWalkShieldSideLeft1\", \"sprites.castle.heroWalkShieldSideLeft2\", \"sprites.castle.heroWalkShieldSideLeft3\", \"sprites.castle.heroWalkShieldSideLeft4\", \"sprites.castle.heroWalkShieldSideRight4\", \"sprites.castle.heroWalkShieldSideRight3\", \"sprites.castle.heroWalkShieldSideRight2\", \"sprites.castle.heroWalkShieldSideRight1\", \"sprites.castle.heroWalkSideLeft1\", \"sprites.castle.heroWalkSideLeft2\", \"sprites.castle.heroWalkSideLeft3\", \"sprites.castle.heroWalkSideLeft4\", \"sprites.castle.heroWalkSideRight4\", \"sprites.castle.heroWalkSideRight3\", \"sprites.castle.heroWalkSideRight2\", \"sprites.castle.heroWalkSideRight1\", \"sprites.castle.houseRed\", \"sprites.castle.houseBlue\", \"sprites.castle.princessFront0\", \"sprites.castle.princessFront1\", \"sprites.castle.princessFront2\", \"sprites.castle.princessLeft0\", \"sprites.castle.princessLeft1\", \"sprites.castle.princessLeft2\", \"sprites.castle.princessBack0\", \"sprites.castle.princessBack1\", \"sprites.castle.princessBack2\", \"sprites.castle.princess2Front\", \"sprites.castle.princess2WalkFront1\", \"sprites.castle.princess2WalkFront2\", \"sprites.castle.princess2WalkFront3\", \"sprites.castle.princess2Back\", \"sprites.castle.princess2WalkBack1\", \"sprites.castle.princess2WalkBack2\", \"sprites.castle.princess2WalkBack3\", \"sprites.castle.princess2Left1\", \"sprites.castle.princess2Left2\", \"sprites.castle.princess2Right1\", \"sprites.castle.princess2Right2\", \"sprites.castle.rock0\", \"sprites.castle.rock1\", \"sprites.castle.rock2\", \"sprites.castle.saplingOak\", \"sprites.castle.saplingPine\", \"sprites.castle.shrub\", \"sprites.castle.skellyFront\", \"sprites.castle.skellyWalkFront1\", \"sprites.castle.skellyWalkFront2\", \"sprites.castle.skellyWalkFront3\", \"sprites.castle.skellyAttackFront1\", \"sprites.castle.skellyAttackFront2\", \"sprites.castle.skellyAttackFront3\", \"sprites.castle.skellyAttackFront4\", \"sprites.castle.skellyWalkLeft1\", \"sprites.castle.skellyAttackLeft1\", \"sprites.castle.skellyAttackLeft2\", \"sprites.castle.skellyWalkLeft2\", \"sprites.castle.skellyWalkRight1\", \"sprites.castle.skellyAttackRight1\", \"sprites.castle.skellyAttackRight2\", \"sprites.castle.skellyWalkRight2\", \"sprites.castle.tileGrass2\", \"sprites.castle.tilePath1\", \"sprites.castle.tilePath2\", \"sprites.castle.tilePath3\", \"sprites.castle.tileGrass1\", \"sprites.castle.tilePath4\", \"sprites.castle.tilePath5\", \"sprites.castle.tilePath6\", \"sprites.castle.tileGrass3\", \"sprites.castle.tilePath7\", \"sprites.castle.tilePath8\", \"sprites.castle.tilePath9\", \"sprites.castle.tileDarkGrass1\", \"sprites.castle.tileDarkGrass2\", \"sprites.castle.tileDarkGrass3\", \"sprites.castle.treePine\", \"sprites.castle.treeOak\", \"sprites.castle.treeSmallPine\", \"sprites.dialog.hugeLeaf\", \"sprites.dialog.largeShell\", \"sprites.dialog.largeStar\", \"sprites.dialog.mediumStar\", \"sprites.dialog.mediumShell\", \"sprites.dialog.mediumLeaf0\", \"sprites.dialog.mediumLeaf1\", \"sprites.dialog.smallIndustrial0\", \"sprites.dialog.smallIndustrial1\", \"sprites.dialog.smallBlue0\", \"sprites.dialog.smallBlue1\", \"sprites.dialog.smallDefault\", \"sprites.dialog.smallSwirlyWhite\", \"sprites.dialog.smallSwirlyPurple\", \"sprites.dialog.smallDialogLeftThin\", \"sprites.dialog.smallDialogLeftThick\", \"sprites.dialog.smallDialogCenterThin\", \"sprites.dialog.smallDialogcenterThick\", \"sprites.duck.duck1\", \"sprites.duck.duck2\", \"sprites.duck.duck3\", \"sprites.duck.duck4\", \"sprites.duck.duck5\", \"sprites.duck.duck6\", \"sprites.duck.duckHurt\", \"sprites.duck.log1\", \"sprites.duck.log2\", \"sprites.duck.log3\", \"sprites.duck.log4\", \"sprites.duck.log5\", \"sprites.duck.log6\", \"sprites.duck.log7\", \"sprites.duck.log8\", \"sprites.duck.tree\", \"sprites.dungeon.buttonOrange\", \"sprites.dungeon.buttonOrangeDepressed\", \"sprites.dungeon.buttonTeal\", \"sprites.dungeon.buttonTealDepressed\", \"sprites.dungeon.buttonPink\", \"sprites.dungeon.buttonPinkDepressed\", \"sprites.dungeon.chestClosed\", \"sprites.dungeon.chestOpen\", \"sprites.dungeon.collectibleInsignia\", \"sprites.dungeon.collectibleRedCrystal\", \"sprites.dungeon.collectibleBlueCrystal\", \"sprites.dungeon.darkGroundNorthWest0\", \"sprites.dungeon.darkGroundNorth\", \"sprites.dungeon.darkGroundNorthEast0\", \"sprites.dungeon.darkGroundNorthWest1\", \"sprites.dungeon.darkGroundWest\", \"sprites.dungeon.darkGroundCenter\", \"sprites.dungeon.darkGroundEast\", \"sprites.dungeon.darkGroundNorthEast1\", \"sprites.dungeon.darkGroundSouthWest0\", \"sprites.dungeon.darkGroundSouth\", \"sprites.dungeon.darkGroundSouthEast0\", \"sprites.dungeon.darkGroundSouthEast1\", \"sprites.dungeon.darkGroundSouthWest1\", \"sprites.dungeon.doorClosedWest\", \"sprites.dungeon.doorClosedSouth\", \"sprites.dungeon.doorClosedNorth\", \"sprites.dungeon.doorClosedEast\", \"sprites.dungeon.doorOpenWest\", \"sprites.dungeon.doorOpenSouth\", \"sprites.dungeon.doorOpenNorth\", \"sprites.dungeon.doorOpenEast\", \"sprites.dungeon.doorLockedWest\", \"sprites.dungeon.doorLockedSouth\", \"sprites.dungeon.doorLockedNorth\", \"sprites.dungeon.doorLockedEast\", \"sprites.dungeon.floorLight0\", \"sprites.dungeon.floorLight1\", \"sprites.dungeon.floorLight2\", \"sprites.dungeon.floorLightMoss\", \"sprites.dungeon.floorLight3\", \"sprites.dungeon.floorLight4\", \"sprites.dungeon.floorLight5\", \"sprites.dungeon.floorMixed\", \"sprites.dungeon.floorDark0\", \"sprites.dungeon.floorDark1\", \"sprites.dungeon.floorDark2\", \"sprites.dungeon.floorDarkDiamond\", \"sprites.dungeon.floorDark3\", \"sprites.dungeon.floorDark4\", \"sprites.dungeon.floorDark5\", \"sprites.dungeon.greenOuterNorthWest\", \"sprites.dungeon.greenOuterNorth0\", \"sprites.dungeon.greenOuterNorth1\", \"sprites.dungeon.greenOuterNorthEast\", \"sprites.dungeon.greenOuterWest0\", \"sprites.dungeon.greenInnerNorthWest\", \"sprites.dungeon.greenInnerNorthEast\", \"sprites.dungeon.greenOuterEast0\", \"sprites.dungeon.greenOuterWest1\", \"sprites.dungeon.greenInnerSouthWest\", \"sprites.dungeon.greenInnerSouthEast\", \"sprites.dungeon.greenOuterEast1\", \"sprites.dungeon.greenOuterSouthEast\", \"sprites.dungeon.greenOuterSouth0\", \"sprites.dungeon.greenOuterSouth1\", \"sprites.dungeon.greenOuterSouthWest\", \"sprites.dungeon.greenOuterNorth2\", \"sprites.dungeon.greenOuterEast2\", \"sprites.dungeon.greenOuterSouth2\", \"sprites.dungeon.greenOuterWest2\", \"sprites.dungeon.greenSwitchUp\", \"sprites.dungeon.greenSwitchDown\", \"sprites.dungeon.hazardWater\", \"sprites.dungeon.hazardLava0\", \"sprites.dungeon.hazardLava1\", \"sprites.dungeon.hazardHole\", \"sprites.dungeon.hazardSpike\", \"sprites.dungeon.purpleOuterNorthWest\", \"sprites.dungeon.purpleOuterNorth0\", \"sprites.dungeon.purpleOuterNorth1\", \"sprites.dungeon.purpleOuterNorthEast\", \"sprites.dungeon.purpleOuterWest0\", \"sprites.dungeon.purpleInnerNorthWest\", \"sprites.dungeon.purpleInnerNorthEast\", \"sprites.dungeon.purpleOuterEast0\", \"sprites.dungeon.purpleOuterWest1\", \"sprites.dungeon.purpleInnerSouthWest\", \"sprites.dungeon.purpleInnerSouthEast\", \"sprites.dungeon.purpleOuterEast1\", \"sprites.dungeon.purpleOuterSouthEast\", \"sprites.dungeon.purpleOuterSouth0\", \"sprites.dungeon.purpleOuterSouth1\", \"sprites.dungeon.purpleOuterSouthWest\", \"sprites.dungeon.purpleOuterNorth2\", \"sprites.dungeon.purpleOuterEast2\", \"sprites.dungeon.purpleOuterSouth2\", \"sprites.dungeon.purpleOuterWest2\", \"sprites.dungeon.purpleSwitchUp\", \"sprites.dungeon.purpleSwitchDown\", \"sprites.dungeon.stairWest\", \"sprites.dungeon.stairSouth\", \"sprites.dungeon.stairNorth\", \"sprites.dungeon.stairEast\", \"sprites.dungeon.stairLarge\", \"sprites.dungeon.stairLadder\", \"sprites.dungeon.statueLight\", \"sprites.dungeon.statueDark\", \"sprites.food.smallBurger\", \"sprites.food.smallApple\", \"sprites.food.smallLemon\", \"sprites.food.smallDrumstick\", \"sprites.food.smallHam\", \"sprites.food.smallPizza\", \"sprites.food.smallDonut\", \"sprites.food.smallCake\", \"sprites.food.smallIceCream\", \"sprites.food.smallStrawberry\", \"sprites.food.smallCherries\", \"sprites.food.smallTaco\", \"sprites.space.spaceSmallAsteroid0\", \"sprites.space.spaceSmallAsteroid1\", \"sprites.space.spaceSmallAsteroid2\", \"sprites.space.spaceSmallAsteroid3\", \"sprites.space.spaceAsteroid0\", \"sprites.space.spaceAsteroid1\", \"sprites.space.spaceSmallAsteroid4\", \"sprites.space.spaceSmallAsteroid5\", \"sprites.space.spaceRedShip\", \"sprites.space.spaceAsteroid2\", \"sprites.space.spaceAsteroid3\", \"sprites.space.spaceAsteroid4\", \"sprites.space.spaceOrangeShip\", \"sprites.space.spacePinkShip\", \"sprites.space.spaceBlueShip\", \"sprites.space.spaceGreenShip\", \"sprites.vehicle.carRedLeft\", \"sprites.vehicle.carRedRight\", \"sprites.vehicle.carRedBack\", \"sprites.vehicle.carRedFront\", \"sprites.vehicle.carBlueLeft\", \"sprites.vehicle.carBlueRight\", \"sprites.vehicle.carBlueBack\", \"sprites.vehicle.carBlueFront\", \"sprites.vehicle.carPinkLeft\", \"sprites.vehicle.carPinkRight\", \"sprites.vehicle.carPinkBack\", \"sprites.vehicle.carPinkFront\", \"sprites.vehicle.roadTurn1\", \"sprites.vehicle.roadTurn2\", \"sprites.vehicle.roadIntersection1\", \"sprites.vehicle.roadIntersection2\", \"sprites.vehicle.roadTurn3\", \"sprites.vehicle.roadTurn4\", \"sprites.vehicle.roadIntersection3\", \"sprites.vehicle.roadIntersection4\", \"sprites.vehicle.roadVertical\", \"sprites.vehicle.roadHorizontal\",\n    \"tiles.util.arrow0\", \"tiles.util.arrow1\", \"tiles.util.arrow2\", \"tiles.util.arrow3\", \"tiles.util.arrow4\", \"tiles.util.arrow5\", \"tiles.util.arrow6\", \"tiles.util.arrow7\", \"tiles.util.arrow8\", \"tiles.util.arrow9\", \"tiles.util.arrow10\", \"tiles.util.arrow11\", \"tiles.util.arrow12\", \"tiles.util.arrow13\", \"tiles.util.arrow14\", \"tiles.util.arrow15\", \"tiles.util.door0\", \"tiles.util.door1\", \"tiles.util.door2\", \"tiles.util.door3\", \"tiles.util.door4\", \"tiles.util.door5\", \"tiles.util.door6\", \"tiles.util.door7\", \"tiles.util.door8\", \"tiles.util.door9\", \"tiles.util.door10\", \"tiles.util.door11\", \"tiles.util.door12\", \"tiles.util.door13\", \"tiles.util.door14\", \"tiles.util.door15\", \"tiles.util.object0\", \"tiles.util.object1\", \"tiles.util.object2\", \"tiles.util.object3\", \"tiles.util.object4\", \"tiles.util.object5\", \"tiles.util.object6\", \"tiles.util.object7\", \"tiles.util.object8\", \"tiles.util.object9\", \"tiles.util.object10\", \"tiles.util.object11\", \"tiles.util.object12\", \"tiles.util.object13\", \"tiles.util.object14\", \"tiles.util.object15\",\n    \"effects.clouds\", \"effects.starField\", \"effects.bubbles\", \"effects.blizzard\", \"effects.disintegrate\", \"effects.ashes\", \"effects.halo\", \"effects.coolRadial\", \"effects.warmRadial\", \"effects.fire\", \"effects.rings\", \"effects.smiles\", \"effects.hearts\", \"effects.confetti\", \"effects.fountain\", \"effects.trail\", \"effects.spray\",\n];","import { ignoredValues } from \"./ignoredfields\";\nimport { getJRESImageFromDataString, getJRESImageFromImageLiteral, JRESImage } from \"./images\";\nimport { IMAGE_MIME_TYPE } from \"./util\";\n\nconst backendEndpoint = \"https://makecode.com/api\";\n\nexport interface JRes {\n    id: string; // something like \"sounds.bark\"\n    data: string;\n    dataEncoding?: string; // must be \"base64\" or missing (meaning the same)\n    icon?: string; // URL (usually data-URI) for the icon\n    namespace?: string; // used to construct id\n    mimeType: string;\n    tilemapTile?: boolean;\n    tileset?: string[];\n}\n\nexport const arcadePalette = [\n    \"#000000\",\n    \"#ffffff\",\n    \"#ff2121\",\n    \"#ff93c4\",\n    \"#ff8135\",\n    \"#fff609\",\n    \"#249ca3\",\n    \"#78dc52\",\n    \"#003fad\",\n    \"#87f2ff\",\n    \"#8e2ec4\",\n    \"#a4839f\",\n    \"#5c406c\",\n    \"#e5cdc4\",\n    \"#91463d\",\n    \"#000000\"\n];\n\n/*\n{\n    \"kind\": \"script\",\n    \"id\": \"62736-71028-62577-28752\",\n    \"shortid\": \"_UAVXEwU7RAew\",\n    \"time\": 1595883166,\n    \"name\": \"Untitled\",\n    \"description\": \"Made with ❤️ in Microsoft MakeCode Arcade.\",\n    \"target\": \"arcade\",\n    \"editor\": \"tsprj\",\n    \"meta\": {\n        \"versions\": {\n            \"branch\": \"v1.0.14\",\n            \"tag\": \"v1.0.14\",\n            \"commits\": \"https://github.com/microsoft/pxt-arcade/commits/1460ac1c88950799eb51c9c297588c8abdc91077\",\n            \"target\": \"1.0.14\",\n            \"pxt\": \"6.1.41\"\n        },\n        \"blocksHeight\": 0,\n        \"blocksWidth\": 0\n    },\n    \"thumb\": false\n}\n*/\n\nexport interface ScriptMeta {\n    kind: \"script\";\n    id: string;\n    shortid: string;\n    time: number;\n    name: string;\n    description: string;\n    target: string;\n    editor: string;\n    meta: {\n        versions: {\n            branch: string;\n            tag: string;\n            commits: string;\n            target: string;\n            pxt: string;\n        };\n        blocksHeight: number;\n        blocksWidth: number;\n    };\n    thumb: boolean;\n    isdeleted?: boolean;\n}\n\nexport interface ScriptInfo {\n    meta: ScriptMeta;\n    files: {[index: string]: string};\n    text: string[];\n    customPalette?: string[];\n    images: JRESImage[];\n}\n\nexport interface ImportedScriptInfo {\n    meta?: ScriptMeta;\n    files: {[index: string]: string};\n    text: BlockFields;\n    customPalette?: string[];\n    projectImages: JRESImage[];\n}\n\n\nexport async function fetchMakeCodeScriptAsync(url: string): Promise<ImportedScriptInfo> {\n    // https://makecode.com/_UAVXEwU7RAew\n    // https://arcade.makecode.com/62736-71028-62577-28752\n    let scriptID = url.trim();\n\n    if (scriptID.indexOf(\"/\") !== -1) {\n        scriptID = scriptID.substr(scriptID.lastIndexOf(\"/\") + 1)\n    }\n\n    const meta: ScriptMeta = await httpGetJSONAsync(backendEndpoint + \"/\" + scriptID);\n\n    // A mapping of filenames to filecontents\n    const filesystem: {[index: string]: string} = await httpGetJSONAsync(backendEndpoint + \"/\" + scriptID + \"/text\");\n\n    const config = filesystem[\"pxt.json\"];\n\n    let palette = arcadePalette;\n    let paletteIsCustom = false;\n\n    if (config) {\n        try {\n            let parsedConfig = JSON.parse(config);\n\n            if (parsedConfig?.palette && Array.isArray(parsedConfig.palette)) {\n                palette = parsedConfig.palette.slice()\n                paletteIsCustom = true;\n            }\n        }\n        catch (e) {\n            // ignore\n        }\n    }\n\n    const projectImages = grabImagesFromProject(filesystem);\n\n    return {\n        meta,\n        files: filesystem,\n        projectImages: projectImages,\n        text: grabTextFromProject(filesystem),\n        customPalette: paletteIsCustom ? palette : undefined\n    };\n}\n\nexport async function parseProject(filesystem: {[index: string]: string}): Promise<ImportedScriptInfo> {\n    const config = filesystem[\"pxt.json\"];\n\n    let palette = arcadePalette;\n    let paletteIsCustom = false;\n\n    if (config) {\n        try {\n            let parsedConfig = JSON.parse(config);\n\n            if (parsedConfig?.palette && Array.isArray(parsedConfig.palette)) {\n                palette = parsedConfig.palette.slice()\n                paletteIsCustom = true;\n            }\n        }\n        catch (e) {\n            // ignore\n        }\n    }\n\n    const projectImages = grabImagesFromProject(filesystem);\n\n    return {\n        files: filesystem,\n        projectImages: projectImages,\n        text: grabTextFromProject(filesystem),\n        customPalette: paletteIsCustom ? palette : undefined\n    };\n}\n\n\nexport interface BlockFields {\n    variableNames: string[];\n    assetNames: string[];\n    other: string[];\n}\n\nexport function grabTextFromProject(filesystem: {[index: string]: string}): BlockFields {\n    const blocks = filesystem[\"main.blocks\"];\n    let strings: string[] = [];\n    let variableNames: string[] = [];\n    let assetNames: string[] = [];\n\n    const literalRegex = /\\s*img\\s*`[\\s\\da-fA-F.#tngrpoywTNGRPOYW]*`\\s*/m;\n    const numbersymbol = /^[+.\\s\\d-]*$/\n\n    ignoredValues.forEach(i => {\n        if (i.startsWith(\"Sprite.\")) {\n            ignoredValues.push(i + \"@set\")\n        }\n    });\n\n    if (blocks) {\n        const xml = new DOMParser().parseFromString(blocks, \"text/xml\");\n        const fields = xml.getElementsByTagName(\"field\");\n        for (let i = 0; i < fields.length; i++) {\n            console.log(fields.item(i)!.getAttribute(\"name\"));\n            const content = fields.item(i)!.textContent?.trim();\n            if (!content || numbersymbol.test(content) || literalRegex.test(content) || ignoredValues.indexOf(content) !== -1) continue;\n\n            const fieldName = fields.item(i)!.getAttribute(\"name\")\n            if (fieldName === \"VAR\") {\n                variableNames.push(content);\n            }\n            else {\n                const match = /^(?:assets\\s*.)?\\s*(?:(?:tilemap)|(?:image)|(?:tile)|(?:animation))\\s*`([^`]+)`\\s*$/.exec(content);\n                if (match) {\n                    if (/(?:myImage|tile|level|myAnim)\\d+/.test(match[1])) continue;\n                    assetNames.push(match[1]);\n                }\n                else {\n                    strings.push(content);\n                }\n            }\n        }\n\n        const comments = xml.getElementsByTagName(\"comment\");\n        for (let i = 0; i < comments.length; i++) {\n            const content = comments.item(i)!.textContent;\n            if (content && !/^[0-9\\s]*$/.test(content) && !literalRegex.test(content) && !numbersymbol.test(content) && ignoredValues.indexOf(content) === -1) {\n                strings.push(content.trim());\n            }\n        }\n    }\n\n    return {\n        other: dedupe(strings),\n        assetNames: dedupe(assetNames),\n        variableNames: dedupe(variableNames)\n    }\n}\n\nfunction dedupe(strings: string[]) {\n    const out: string[] = []\n    strings.forEach(s => {\n        if (out.indexOf(s) === -1) {\n            out.push(s);\n        }\n    })\n    return out;\n}\n\n\nexport function grabImagesFromProject(filesystem: {[index: string]: string}, palette = arcadePalette) {\n    // Don't bother checking python and blocks files, they should all get converted to a matching ts\n    // file that will also contain all image literals\n    const typescriptFiles = Object.keys(filesystem).filter(filename =>\n        filename.endsWith(\".ts\") || filename.endsWith(\".jres\"));\n\n    // Grab any existing images in the project\n    const projectImages: JRESImage[] = [];\n    for (const filename of typescriptFiles) {\n\n        const fileText = filesystem[filename];\n        if (filename.endsWith(\"jres\")) {\n            projectImages.push(...grabImagesFromJRES(fileText, filename, palette));\n        }\n        else {\n            projectImages.push(...grabImagesFromTypeScript(fileText, filename, palette));\n        }\n    }\n\n    // Dedupe the images based on their content\n    const seenImages: {[index: string]: JRESImage} = {};\n\n    for (const image of projectImages) {\n        const existing = seenImages[image.data];\n        // Prefer images that have qualified names (from JRES)\n        if (!existing || (!existing.qualifiedName && image.qualifiedName)) {\n            seenImages[image.data] = image;\n        }\n    }\n\n    return Object.keys(seenImages).map(data => seenImages[data]);\n}\n\nfunction grabImagesFromJRES(jresText: string, filename: string, palette = arcadePalette): JRESImage[] {\n    let jres: {[index: string]: JRes | string};\n\n    try {\n        jres = JSON.parse(jresText);\n    }\n    catch (e) {\n        return [];\n    }\n\n    const metaEntry = jres[\"*\"] as JRes | undefined;\n\n    const metaMime = metaEntry?.mimeType || \"\";\n    const metaNamespace = metaEntry?.namespace || \"\";\n\n    const result: JRESImage[] = [];\n\n    for (const id of Object.keys(jres)) {\n        if (id === \"*\") continue;\n\n        let entry = jres[id];\n\n        if (typeof entry === \"string\") {\n            if (metaMime === IMAGE_MIME_TYPE) {\n                result.push(getJRESImageFromDataString(entry, palette, metaNamespace ? metaNamespace + \".\" + id : id, false, filename));\n            }\n        }\n        else if (entry.mimeType === IMAGE_MIME_TYPE) {\n            result.push(getJRESImageFromDataString(entry.data, palette, metaNamespace ? metaNamespace + \".\" + id : id, entry.tilemapTile, filename));\n        }\n    }\n\n    return result\n}\n\nfunction grabImagesFromTypeScript(fileText: string, filename: string, palette = arcadePalette) {\n    const literalRegex = /img\\s*`[\\s\\da-f.#tngrpoyw]*`/img;\n\n    const res: JRESImage[] = [];\n\n    fileText.replace(literalRegex, match => {\n        res.push(getJRESImageFromImageLiteral(match, palette, filename))\n        return \"\";\n    });\n\n    return res;\n}\n\n\nfunction httpGetJSONAsync(url: string): Promise<any> {\n    return new Promise((resolve, reject) => {\n        const request = new XMLHttpRequest();\n\n        request.addEventListener(\"error\", err => {\n            reject(err);\n        });\n\n        request.addEventListener(\"load\", () => {\n            try {\n                resolve(JSON.parse(request.responseText));\n            }\n            catch (e) {\n                reject(e);\n            }\n        });\n\n        request.open(\"GET\", url);\n        request.send();\n    });\n}","import { uint8ArrayToString } from \"./util\";\n\nexport function setupDragAndDrop(r: HTMLElement, filter: (file: File) => boolean, dragged: (files: File[]) => void) {\n    r.addEventListener('paste', function (e: ClipboardEvent) {\n        if (e.clipboardData) {\n            // has file?\n            let files: File[] = [];\n            for (let i = 0; i < e.clipboardData.files.length; i++) {\n                if (e.clipboardData.files.item(i)) files.push(e.clipboardData.files.item(i) as File);\n            }\n            files = files.filter(filter);\n            if (files.length > 0) {\n                e.stopPropagation(); // Stops some browsers from redirecting.\n                e.preventDefault();\n                dragged(files);\n            }\n            // has item?\n            else if (e.clipboardData.items && e.clipboardData.items.length > 0) {\n                let f = e.clipboardData.items[0].getAsFile()\n                if (f) {\n                    e.stopPropagation(); // Stops some browsers from redirecting.\n                    e.preventDefault();\n                    dragged([f])\n                }\n            }\n        }\n    })\n    r.addEventListener('dragover', function (e: DragEvent) {\n        if (e.dataTransfer) {\n            let types = e.dataTransfer.types;\n            let found = false;\n            for (let i = 0; i < types.length; ++i)\n                if (types[i] === \"Files\")\n                    found = true;\n            if (found) {\n                if (e.preventDefault) e.preventDefault(); // Necessary. Allows us to drop.\n                e.dataTransfer.dropEffect = 'copy';  // See the section on the DataTransfer object.\n                return false;\n            }\n        }\n        return true;\n    }, false);\n    r.addEventListener('drop', function (e: DragEvent) {\n        if (e.dataTransfer) {\n            const files: File[] = [];\n            for (let i = 0; i < e.dataTransfer.files.length; i++) {\n                if (e.dataTransfer.files.item(i)) files.push(e.dataTransfer.files.item(i) as File);\n            }\n            if (files.length > 0) {\n                e.stopPropagation(); // Stops some browsers from redirecting.\n                e.preventDefault();\n                dragged(files);\n            }\n        }\n        return false;\n    }, false);\n    r.addEventListener('dragend', function (e: DragEvent) {\n        return false;\n    }, false);\n}\n\nexport function fileReadAsBufferAsync(f: File): Promise<Uint8Array | null> { // ArrayBuffer\n    if (!f)\n        return Promise.resolve<Uint8Array | null>(null);\n    else {\n        return new Promise<Uint8Array | null>((resolve, reject) => {\n            let reader = new FileReader();\n            reader.onerror = (ev) => resolve(null);\n            reader.onload = (ev) => resolve(new Uint8Array(reader.result as ArrayBuffer));\n            reader.readAsArrayBuffer(f);\n        });\n    }\n}\n\nexport function fileReadAsTextAsync(f: File): Promise<string | null> {\n    if (!f)\n        return Promise.resolve<string| null>(null);\n    else {\n        return new Promise<string | null>((resolve, reject) => {\n            let reader = new FileReader();\n            reader.onerror = (ev) => resolve(null);\n            reader.onload = (ev) => resolve(reader.result as string);\n            reader.readAsText(f);\n        });\n    }\n}\n\nexport async function decodePNG(file: File) {\n    const buffer = await fileReadAsBufferAsync(file);\n    if (!buffer) return;\n\n    return decodeBlobAsync(\"data:image/png;base64,\" + btoa(uint8ArrayToString(buffer)));\n}\n\nasync function decodeBlobAsync(dataURL: string) {\n    const canvas = await loadCanvasAsync(dataURL);\n\n    const ctx = canvas.getContext(\"2d\")!\n    const imgdat = ctx.getImageData(0, 0, canvas.width, canvas.height)\n    const d = imgdat.data\n    const bpp = (d[0] & 1) | ((d[1] & 1) << 1) | ((d[2] & 1) << 2)\n    // Safari sometimes just reads a buffer full of 0's so we also need to bail if bpp == 0\n    if (bpp > 5 || bpp === 0)\n        return Promise.reject(new Error(\"Invalid encoded PNG format\"))\n\n    function decode(ptr: number, bpp: number, trg: Uint8Array) {\n        let shift = 0\n        let i = 0\n        let acc = 0\n        const mask = (1 << bpp) - 1\n        while (i < trg.length) {\n            acc |= (d[ptr++] & mask) << shift\n            if ((ptr & 3) == 3)\n                ptr++ // skip alpha\n            shift += bpp\n            if (shift >= 8) {\n                trg[i++] = acc & 0xff\n                acc >>= 8\n                shift -= 8\n            }\n        }\n        return ptr\n    }\n\n    const hd = new Uint8Array(imageHeaderSize)\n    let ptr = decode(4, bpp, hd)\n    const dhd = decodeU32LE(hd)\n    if (dhd[0] !== imageMagic)\n        return Promise.reject(new Error(\"Invalid magic in encoded PNG\"))\n    const res = new Uint8Array(dhd[1])\n    const addedLines = dhd[2]\n    if (addedLines > 0) {\n        const origSize = (canvas.height - addedLines) * canvas.width\n        const imgCap = (origSize - 1) * 3 * bpp >> 3\n        const tmp = new Uint8Array(imgCap - imageHeaderSize)\n        decode(ptr, bpp, tmp)\n        res.set(tmp)\n        const added = new Uint8Array(res.length - tmp.length)\n        decode(origSize * 4, 8, added)\n        res.set(added, tmp.length)\n    } else {\n        decode(ptr, bpp, res)\n    }\n    return res\n}\n\nfunction loadImageAsync(data: string): Promise<HTMLImageElement | undefined> {\n    const img = document.createElement(\"img\")\n    return new Promise<HTMLImageElement | undefined>((resolve, reject) => {\n        img.onload = () => resolve(img);\n        img.onerror = () => resolve(undefined);\n        img.crossOrigin = \"anonymous\";\n        img.src = data;\n    });\n}\n\nfunction loadCanvasAsync(url: string): Promise<HTMLCanvasElement> {\n    return loadImageAsync(url)\n        .then(img => {\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = img!.width\n            canvas.height = img!.height\n            const ctx = canvas.getContext(\"2d\")\n            ctx!.drawImage(img!, 0, 0);\n            return canvas;\n        })\n}\n\nfunction read32(buf: ArrayLike<number>, pos: number) {\n    return (buf[pos] | (buf[pos + 1] << 8) | (buf[pos + 2] << 16) | (buf[pos + 3] << 24)) >>> 0\n}\n\nfunction decodeU32LE(buf: Uint8Array) {\n    let res: number[] = []\n    for (let i = 0; i < buf.length; i += 4)\n        res.push(read32(buf, i))\n    return res\n}\n\nconst imageMagic = 0x59347a7d // randomly selected\nconst imageHeaderSize = 36 // has to be divisible by 9","\n// @ts-ignore\nimport * as LZMA from \"../node_modules/lzma/src/lzma_worker-min\";\n\nexport function lzmaCompressAsync(text: string) {\n    const lzma = LZMA.LZMA;\n\n    return new Promise<Uint8Array>((resolve, reject) => {\n        try {\n            lzma.compress(text, 7, (res: any, error: any) => {\n                if (error) reject(error);\n                else resolve(new Uint8Array(res));\n            });\n        }\n        catch (e) {\n            reject(e);\n        }\n    });\n}\n\nexport function lzmaDecompressAsync(data: Uint8Array) {\n    const lzma = LZMA.LZMA;\n\n    return new Promise<string>((resolve, reject) => {\n        try {\n            lzma.decompress(data, (res: string, error: any) => {\n                if (error) reject(error);\n                else resolve(res);\n            });\n        }\n        catch (e) {\n            reject(e);\n        }\n    });\n}","import { AssetInfo, Asset } from \"./components/Asset\";\nimport { lzmaCompressAsync } from \"./lzma\";\nimport { JRes } from \"./share\";\nimport { escapeIdentifier, IMAGE_MIME_TYPE, browserDownloadUInt8Array, browserDownloadText } from \"./util\";\nimport { imgEncodeJRESImage } from \"./images\";\n\n\ninterface PXTHexFile {\n    meta: {\n        cloudId: \"pxt/arcade\";\n        targetVersions: any;\n        editor: \"tsprj\";\n        name: string;\n    };\n    source: string; // a mapping of filenames to file text that has been stringified\n}\n\nconst PROJECT_COMMENT = `/*\n * This project was created using arcade-sprite-pack. If you\n * want to publish this project to GitHub as a sprite pack, do\n * not add any code to this file! The code that is running in the\n * simulator can be edited by clicking on the file explorer to the\n * left and selecting \"test.ts\". Any code added to \"test.ts\" will\n * not be added to a project that imports this sprite pack as an\n * extension.\n *\n * If you don't wish to publish this project, you can use this project\n * as-is. Your sprites should show up in the sprite gallery. Make sure\n * you delete the code in \"test.ts\"!\n *\n *\n * To publish this project to GitHub:\n *   1. Rename this project to something descriptive\n *   2. Click the GitHub button in the bottom bar next to the save\n *      button (sign in to GitHub if prompted)\n *   3. Choose a name for your repository. This is the name that\n *      people will see when importing your project.\n *   4. Make sure \"public repository\" is selected in the dropdown\n *      if you want other people to be able to use your sprites\n *   5. Click \"go ahead\"\n *   6. If you are on a shared computer, make sure you sign out of\n *      GitHub!\n *\n *\n * To add a published project to an Arcade project:\n *   1. Inside the MakeCode editor, click \"Extensions\" under \"Advanced\"\n *      in the toolbox\n *   2. Inside the search box that appears, type your GitHub username\n *      followed by a \"/\" and the name of the repository. It should\n *      look something like this: username/repository\n *   3. Hit enter on your keyboard and click the card that appears\n *   4. The sprites should now show up in the gallery of the sprite\n *      editor (at the bottom)\n * */\n`;\n\nconst TEST_SCRIPT = `\nconst padding = 10;\nconst speed = 50;\ngame.onUpdate(function() {\n    for (const sprite of sprites.allOfKind(SpriteKind.Player)) {\n        if (sprite.vx > 0 && sprite.x >= screen.width - padding) {\n            sprite.x = screen.width - padding;\n            sprite.vx = 0;\n            sprite.vy = speed;\n        }\n        else if (sprite.vy > 0 && sprite.y >= screen.height - padding) {\n            sprite.y = screen.height - padding;\n            sprite.vx = -speed;\n            sprite.vy = 0;\n        }\n        else if (sprite.vx < 0 && sprite.x <= padding) {\n            sprite.x = padding;\n            sprite.vx = 0;\n            sprite.vy = -speed;\n        }\n        else if (sprite.vy < 0 && sprite.bottom <= 0) {\n            sprite.destroy();\n        }\n    }\n})\n\nlet index = 0;\ngame.onUpdateInterval(700, function() {\n    const asset = sprites.create(allImages[index], SpriteKind.Player);\n    asset.x = padding;\n    asset.y = padding;\n    asset.vx = speed;\n    asset.setFlag(SpriteFlag.Ghost, true)\n    index = (index + 1) % allImages.length;\n})\n\nlet line1 = sprites.create(img\\`0\\`, SpriteKind.Food)\nline1.say(\"PRESS A TO  \")\n\nlet line2 = sprites.create(img\\`0\\`, SpriteKind.Food)\nline2.say(\"CHANGE COLOR\")\nline2.top += 10\n\nlet bgColor = 0;\ncontroller.player1.onButtonEvent(ControllerButton.A, ControllerButtonEvent.Pressed, function() {\n    scene.setBackgroundColor(bgColor);\n    bgColor = (bgColor + 1) % 15\n})`;\n\nconst MAIN_BLOCKS = \"main.blocks\"\nconst ASSET_TS = \"assets.ts\";\nconst ASSET_JRES = \"assets.jres\"\nconst TEST_TS = \"test.ts\";\nconst MAIN_TS = \"main.ts\";\nconst PXT_JSON = \"pxt.json\";\nconst README_MD = \"README.md\";\n\n\nfunction createProjectBlobAsync(name: string, assetTS: string, assetJRES: string, testTS: string) {\n    const config = JSON.stringify({\n        \"name\": name,\n        \"dependencies\": {\n            \"device\": \"*\" // required for arcade\n        },\n        \"description\": \"An asset pack for MakeCode Arcade\",\n        \"files\": [\n            MAIN_BLOCKS,\n            MAIN_TS,\n            ASSET_JRES,\n            ASSET_TS\n        ],\n        \"testFiles\": [\n            TEST_TS\n        ]\n    }, null, 4);\n\n\n    const files: {[index: string]: string} = {};\n    files[PXT_JSON] = config;\n    files[MAIN_TS] = PROJECT_COMMENT;\n    files[TEST_TS] = testTS;\n    files[ASSET_TS] = assetTS;\n    files[ASSET_JRES] = assetJRES;\n    files[README_MD] = \"\"\n    files[MAIN_BLOCKS] =`<xml xmlns=\"http://www.w3.org/1999/xhtml\"><variables></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"></block></xml>`;\n\n\n    const project: PXTHexFile = {\n        meta: {\n            cloudId: \"pxt/arcade\",\n            targetVersions: {},\n            name: name,\n            editor: \"tsprj\"\n        },\n        source: JSON.stringify(files)\n    };\n\n    return lzmaCompressAsync(JSON.stringify(project));\n}\n\nexport async function downloadProjectAsync(name: string, assets: AssetInfo[]) {\n    let assetTS = \"\";\n\n    const assetJRES: {[index: string]: JRes | string} = {};\n    const takenNames: {[index: string]: boolean} = {};\n\n    const projectNamespace = escapeIdentifier(name) + \"Sprites\";\n    const qualifiedNames: string[] = [];\n\n\n    // @ts-ignore\n    assetJRES[\"*\"] = {\n        namespace: projectNamespace,\n        mimeType: IMAGE_MIME_TYPE\n    }\n\n    for (const asset of assets) {\n        const identifier = escapeName(asset.name);\n\n        if (asset.jres.tilemapTile) {\n            assetJRES[identifier] = {\n                id: identifier,\n                data: asset.jres.data,\n                tilemapTile: true,\n                mimeType: IMAGE_MIME_TYPE\n            };\n            assetTS += `    //% fixedInstance jres blockIdentity=images._tile\\n`\n        }\n        else {\n            assetJRES[identifier] = asset.jres.data;\n            assetTS += `    //% fixedInstance jres blockIdentity=images._image\\n`\n        }\n\n        assetTS += `    export const ${identifier} = image.ofBuffer(hex\\`\\`);\\n`\n        qualifiedNames.push(projectNamespace + \".\" + identifier);\n    }\n\n    assetTS = `namespace ${projectNamespace} {\\n${assetTS}\\n}\\n`;\n\n    const testTS = `const allImages = [${qualifiedNames.join(\",\")}]\\n${TEST_SCRIPT}`;\n    const project = await createProjectBlobAsync(name, assetTS, JSON.stringify(assetJRES), testTS);\n    return browserDownloadUInt8Array(project, name + \".mkcd\");\n\n\n\n    function escapeName(name: string) {\n        const escaped = escapeIdentifier(name);\n\n        if (!takenNames[escaped]) {\n            takenNames[escaped] = true;\n            return escaped;\n        }\n\n        let index = 2;\n        while (takenNames[escaped + index]) {\n            index++;\n        }\n\n        takenNames[escaped + index] = true;\n        return escaped + index;\n    }\n}\n\nexport async function downloadTypeScriptAsync(name: string, assets: AssetInfo[]) {\n    let assetTS = \"\";\n\n    let takenNames: {[index: string]: boolean} = {};\n\n    for (const asset of assets) {\n        assetTS += `const ${escapeName(asset.name)} = ${imgEncodeJRESImage(asset.jres)};\\n`\n    }\n\n    return browserDownloadText(assetTS, name + \".ts\");\n\n    function escapeName(name: string) {\n        const escaped = escapeIdentifier(name);\n\n        if (!takenNames[escaped]) {\n            takenNames[escaped] = true;\n            return escaped;\n        }\n\n        let index = 2;\n        while (takenNames[escaped + index]) {\n            index++;\n        }\n\n        takenNames[escaped + index] = true;\n        return escaped + index;\n    }\n}","const PATCH_DB_NAME = \"APPROVED_DB\";\nlet _db: IDBDatabase;\nlet openPromise: Promise<IDBDatabase>;\n\ninterface StringEntry {\n    str: string;\n    approved: boolean;\n    time: number\n}\n\nasync function initDBAsync() {\n    if (_db) return _db;\n\n    if (!openPromise) {\n        openPromise = new Promise((resolve, reject) => {\n\n            const request = indexedDB.open(PATCH_DB_NAME, 2);\n\n            request.onerror = event => {\n                reject();\n            };\n\n            request.onupgradeneeded = event => {\n                const db = request.result;\n                const objectStore = db.createObjectStore(\n                    \"approved\",\n                    {\n                        keyPath: \"str\"\n                    }\n                );\n                objectStore.createIndex(\"str\", \"str\", { unique: true });\n                objectStore.createIndex(\"approved\", \"approved\", { unique: false });\n                objectStore.createIndex(\"time\", \"time\", { unique: false });\n            };\n\n            request.onsuccess = event => {\n                _db = request.result;\n                resolve(_db);\n            }\n        });\n    }\n\n    return openPromise;\n}\n\nasync function lookupEntryAsync(str: string): Promise<StringEntry | undefined> {\n    const db = await initDBAsync();\n\n    return new Promise((resolve, reject) => {\n        const transaction = db.transaction([\"approved\"], \"readwrite\");\n        const objectStore = transaction.objectStore(\"approved\");\n        const request = objectStore.get(str) as IDBRequest<StringEntry>;\n        request.onerror = event => {\n            reject();\n        };\n        request.onsuccess = event => {\n            resolve(request.result);\n        };\n    })\n}\n\nasync function addEntryAsync(str: string, approved: boolean): Promise<void> {\n    const db = await initDBAsync();\n\n    return new Promise<void>((resolve, reject) => {\n        const transaction = db.transaction([\"approved\"], \"readwrite\");\n        const objectStore = transaction.objectStore(\"approved\");\n        const request = objectStore.add({\n            str,\n            approved,\n            time: Date.now()\n        });\n        request.onerror = event => {\n            reject();\n        };\n        request.onsuccess = event => {\n            resolve()\n        };\n    })\n}\n\n\nexport async function isStringApprovedAsync(str: string) {\n    const entry = await lookupEntryAsync(str);\n\n    if (entry) return entry.approved;\n    return false;\n}\n\nexport async function markStringApprovedAsync(str: string) {\n    await addEntryAsync(str, true);\n}\n","import React from 'react';\nimport { Alert, AlertProps } from './Alert';\nimport { Asset, AssetInfo } from './Asset';\nimport { JRESImage, getJRESImageFromDataString, getJRESImageFromUint8Array } from '../images'\nimport { arcadePalette, BlockFields, fetchMakeCodeScriptAsync, grabImagesFromProject, ImportedScriptInfo, parseProject } from '../share';\nimport { setupDragAndDrop, fileReadAsBufferAsync, decodePNG } from '../dragAndDrop';\nimport '../styles/AssetList.css';\nimport { downloadProjectAsync, downloadTypeScriptAsync } from '../export';\nimport { lzmaDecompressAsync } from '../lzma';\nimport { isStringApprovedAsync, markStringApprovedAsync } from '../db';\n\ninterface AlertInfo extends AlertProps {\n    type: \"delete\" | \"import\" | \"warning\" | \"export\";\n}\n\ninterface FileInfo {\n    name: string;\n    content: string;\n}\n\ninterface AssetListProps {\n    postMessage: (msg: any) => void;\n}\n\ninterface AssetListState {\n    items: AssetInfo[];\n    runUrl?: string;\n    isDeleted?: boolean;\n    selected: number;\n    saving?: number;\n    dragging?: boolean;\n    alert?: AlertInfo;\n    textItems?: BlockFields;\n    files?: FileInfo[];\n}\n\nconst DEFAULT_NAME = \"mySprite\";\nconst DEFAULT_JRES = {\n    data: \"hwQQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\",\n    previewURI: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAH0lEQVQ4T2NkoBAwUqifYdQAhtEwYBgNA1A+Gvi8AAAmmAARf9qcXAAAAABJRU5ErkJggg==\",\n    width: 16,\n    height: 16,\n}\n\nconst STORAGE_KEY = \"SPRITE_DATA\"\nconst SAVE_INTERVAL = 2000; // autosave every 2s\nconst PROJECT_NAME = \"spritePack\"\n\nclass AssetList extends React.Component<AssetListProps, AssetListState> {\n    private _items: AssetInfo[];\n    private _importInputRef!: HTMLInputElement;\n    private _exportInputRef!: HTMLInputElement;\n    private _dragInit: boolean = false;\n\n    constructor(props: AssetListProps) {\n        super(props);\n        this._items = [];\n\n        this.state = {\n            items: this._items,\n            selected: 0,\n            alert: {\n                type: \"import\",\n                icon: \"upload\",\n                title: \"Import Sprites\",\n                text: \"Paste a URL from MakeCode Arcade or drag and drop PNG files to import a project.\",\n                options: [{\n                        text: \"Import\",\n                        onClick: () => {\n                            this.importAssets(this._importInputRef.value);\n                            this.hideAlert();\n                        }\n                    }]\n            }\n        };\n    }\n\n    componentDidMount() {\n        window.addEventListener(\"message\", this.handleMessage);\n        // this.loadJres(this._items[this.state.selected]);\n\n        // TODO: intermittent bug where floating layers are not registered\n        // in the \"update\" probably to do with pxt-side handling of getJres\n        setTimeout(this.autosaveJres, SAVE_INTERVAL);\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener(\"message\", this.handleMessage);\n        window.localStorage.setItem(STORAGE_KEY, JSON.stringify(this._items));\n    }\n\n    componentDidUpdate(prevProps: AssetListProps, prevState: AssetListState) {\n        if (this.state.saving !== undefined && prevState.saving === undefined) {\n            this.getJres();\n        }\n\n        if (this.state.selected !== prevState.selected ||\n            this.state.items.length !== prevState.items.length) {\n            this.loadJres(this._items[this.state.selected]);\n        }\n        window.localStorage.setItem(STORAGE_KEY, JSON.stringify(this._items));\n    }\n\n    handleMessage = (msg: any) => {\n        const data = msg.data;\n        switch (data.type) {\n            case \"ready\":\n                this.loadJres(this._items[this.state.selected]);\n                break;\n            case \"update\":\n                const jresImage = getJRESImageFromDataString(data.message, arcadePalette);\n                if (this.state.saving !== undefined) {\n                    const saving = this.state.saving;\n                    this._items[this.state.selected].jres = jresImage;\n                    this.setState({\n                        items: this._items,\n                        selected: saving,\n                        saving: undefined\n                    });\n                } else {\n                    this._items[this.state.selected].jres = jresImage;\n                    this.setState({ items: this._items });\n                }\n                break;\n            default:\n                break;\n        }\n    }\n\n    autosaveJres = () => {\n        if (!this.state.saving) this.getJres();\n        setTimeout(this.autosaveJres, SAVE_INTERVAL);\n    }\n\n    loadJres = (asset: AssetInfo) => {\n        this.props.postMessage({ type: \"initialize\", message: asset.jres.data });\n    }\n\n    getJres = () => {\n        this.props.postMessage({ type: \"update\" });\n    }\n\n    /** ASSET HANDLING */\n\n    addAsset(name?: string, jres?: JRESImage) {\n        this._items.push({\n            name: this.getValidAssetName(name || DEFAULT_NAME),\n            jres: jres || { ...DEFAULT_JRES }\n        })\n        this.setState({\n            items: this._items,\n            saving: this._items.length - 1\n         });\n    }\n\n    deleteAsset(index: number) {\n        this._items = this._items.filter((el, i) => i !== index);\n        this.setState({\n            items: this._items,\n            selected: Math.max(index - 1, 0)\n         })\n    }\n\n    renameAsset(index: number, newName: string) {\n        if (this._items[index].name !== newName) {\n            this._items[index].name = this.getValidAssetName(newName);\n            this.setState({ items: this._items });\n        }\n    }\n\n    clearAssets() {\n        this._items = [{\n            name: DEFAULT_NAME,\n            jres: { ...DEFAULT_JRES }\n        }];\n        this.setState({ items: this._items, selected: 0 });\n    }\n\n    async importAssets(url: string, replace?: boolean) {\n        const res = await fetchMakeCodeScriptAsync(url);\n        await this.importAssetsCore(res, replace);\n    }\n\n    async importAssetsCore(res: ImportedScriptInfo, replace?: boolean) {\n        const scriptId = res?.meta?.id;\n        const scriptTarget = res?.meta?.target;\n        const runUrl = scriptId && scriptTarget && `https://${res?.meta?.target}.makecode.com/---run?id=${res?.meta?.id}&noFooter=1&single=1&fullScreen=1`;\n\n        const cvsHatesThisScript = res?.meta?.isdeleted;\n\n        if (replace) this._items = [];\n        for (const el of res.projectImages) {\n            if (!(await isStringApprovedAsync(el.previewURI))) {\n                this._items.push({ name: el.qualifiedName || this.getValidAssetName(DEFAULT_NAME), jres: el })\n            }\n        }\n\n        let files: FileInfo[] = [];\n        let ignoredFiles = [\"images.g.jres\", \"images.g.ts\", \"main.blocks\", \"tilemap.g.jres\", \"tilemap.g.ts\"]\n\n        for (const file of Object.keys(res.files)) {\n            if (ignoredFiles.indexOf(file) === -1) {\n                files.push({\n                    name: file,\n                    content: res.files[file]\n                });\n            }\n        }\n\n        files = files.filter(f => !!f.content.trim())\n\n        const priorities = [\".md\", \".json\", \".py\", \".ts\"];\n\n        files.sort((a, b) => {\n            const aPriority = priorities.indexOf(a.name.substr(a.name.lastIndexOf(\".\")));\n            const bPriority = priorities.indexOf(b.name.substr(b.name.lastIndexOf(\".\")));\n            return aPriority - bPriority;\n        })\n\n        const unapprovedText: BlockFields = {\n            other: [],\n            assetNames: [],\n            variableNames: []\n        }\n\n        if (res.text) {\n            for (const str of res.text.other) {\n                if (!(await isStringApprovedAsync(str))) {\n                    unapprovedText.other.push(str);\n                }\n            }\n\n            for (const str of res.text.assetNames) {\n                if (!(await isStringApprovedAsync(str))) {\n                    unapprovedText.assetNames.push(str);\n                }\n            }\n\n            for (const str of res.text.variableNames) {\n                if (!(await isStringApprovedAsync(str))) {\n                    unapprovedText.variableNames.push(str);\n                }\n            }\n        }\n\n        this.setState({\n            items: this._items,\n            textItems: unapprovedText,\n            files,\n            runUrl,\n            isDeleted: cvsHatesThisScript,\n        });\n    }\n\n    getAssetIndex(name: string): number {\n        return this._items.findIndex((el) => el.name.toLowerCase() === name.toLowerCase());\n    }\n\n    getValidAssetName(name: string): string {\n        name = name.replace(/[^a-zA-Z0-9]/g, '');\n        while (this.getAssetIndex(name) >= 0) {\n            let r = name.match(/^(.*?)(\\d+)$/);\n            // increment counter by one\n            name = r ? r[1] + (parseInt(r[2], 10) + 1) : name + \"2\";\n        }\n        return name;\n    }\n\n    /** ASSET EVENT LISTENERS */\n\n    onAssetClick = (index: number): (e: any) => void => {\n        return () => {\n            this.setState({ saving: index });\n        }\n    }\n\n    onAssetRename = (index: number): (name: string) => void => {\n        return (name: string) => { this.renameAsset(index, name) };\n    }\n\n    onAssetDelete = () => {\n        if (this._items.length > 1) {\n            this.setState({\n                alert: {\n                    type: \"delete\",\n                    icon: \"exclamation triangle\",\n                    title: \"Warning!\",\n                    text: \"Deleting an image is permanent. You will not be able to undo this action.\",\n                    options: [{\n                            text: \"Delete\",\n                            onClick: () => {\n                                this.deleteAsset(this.state.selected);\n                                this.hideAlert();\n                            }\n                        }]\n                }\n            })\n        } else {\n            this.setState({\n                alert: {\n                    type: \"warning\",\n                    icon: \"ban\",\n                    title: \"Unable to delete\",\n                    text: \"You must have at least one image in your project.\",\n                }\n            })\n        }\n    }\n\n    onAddButtonClick = () => {\n        this.addAsset(DEFAULT_NAME);\n    }\n\n    onDeleteButtonClick = () => {\n        this.setState({\n            alert: {\n                type: \"delete\",\n                icon: \"exclamation triangle\",\n                title: \"WARNING\",\n                text: \"This will delete ALL assets in this project. You will not be able to undo this action.\",\n                options: [{\n                        text: \"Delete All\",\n                        style: {\n                            backgroundColor: \"#dc3f34\"\n                        },\n                        onClick: () => {\n                            this.clearAssets();\n                            this.hideAlert();\n                        }\n                    }]\n            }\n        })\n    }\n\n    onPaste = (ev: React.ClipboardEvent<HTMLInputElement>) => {\n        this.clearAssets();\n        this.importAssets(ev.clipboardData.getData(\"text\"));\n        this.hideAlert();\n    }\n\n    onImportButtonClick = () => {\n        this.setState({\n            alert: {\n                type: \"import\",\n                icon: \"upload\",\n                title: \"Import Sprites\",\n                text: \"Paste a URL from MakeCode Arcade or drag and drop PNG files to import existing sprites.\",\n                options: [{\n                        text: \"Import\",\n                        onClick: () => {\n                            this.importAssets(this._importInputRef.value);\n                            this.hideAlert();\n                        }\n                    }]\n            }\n        })\n    }\n\n    onImportDragEnter = (e: any) => {\n        this.setState({ dragging: true });\n    }\n\n    onImportDragLeave = (e: any) => {\n        this.setState({ dragging: false });\n    }\n\n    onExportButtonClick = () => {\n        // ensure we have most updated sprites\n        this.getJres();\n        this.setState({\n            alert: {\n                type: \"export\",\n                icon: \"download\",\n                title: \"Export Sprite Pack\",\n                text: \"Export your sprites as an .mckd project to load directly into Arcade, or as a .ts file with your images encoded.\",\n                options: [{\n                        text: \"Download MKCD\",\n                        onClick: () => {\n                            // download as MKCD\n                            this.hideAlert();\n                            downloadProjectAsync(this._exportInputRef.value || PROJECT_NAME, this.state.items);\n                        }\n                    },\n                    {\n                        text: \"Download TS\",\n                        onClick: () => {\n                            // download as TS\n                            this.hideAlert();\n                            downloadTypeScriptAsync(this._exportInputRef.value || PROJECT_NAME, this.state.items);\n                        }\n                    }]\n            }\n        })\n    }\n\n    hideAlert = () => {\n        this.setState({ alert: undefined });\n    }\n\n    /* REF HANDLING */\n\n    handleImportInputRef = (el: HTMLInputElement) => {\n        this._importInputRef = el;\n    }\n\n    handleExportInputRef = (el: HTMLInputElement) => {\n        this._exportInputRef = el;\n    }\n\n    handleDropRef = (el: HTMLInputElement) => {\n        if (!this._dragInit) {\n            this._dragInit = true;\n            setupDragAndDrop(document.body, f => true, async files => {\n                for (const f of files) {\n                    const idx = f.name.lastIndexOf(\".\");\n                    const ext = f.name.substr(idx);\n                    if (ext.toLowerCase() === \".png\") {\n                        const buf = await decodePNG(f);\n                        await this.importBuffer(buf);\n                    }\n                    else if (ext.toLowerCase() === \".mkcd\") {\n                        const buf = await fileReadAsBufferAsync(f);\n                        await this.importBuffer(buf);\n                    }\n                }\n            });\n        }\n    }\n\n    async importBuffer(buf: Uint8Array | undefined | null) {\n        if (buf) {\n            const text = await lzmaDecompressAsync(buf);\n            try {\n                const project = JSON.parse(text);\n                const files = JSON.parse(project.source);\n                const parsed = await parseProject(files);\n\n                await this.importAssetsCore(parsed, true);\n                this.hideAlert();\n            }\n            catch (e) {\n\n            }\n        }\n    }\n\n    async approveAllStringsAsync(type: keyof BlockFields) {\n        const strs = this.state.textItems![type];\n\n        for (const str of strs) {\n            await markStringApprovedAsync(str)\n        }\n\n        this.setState({\n            textItems: {\n                assetNames: this.state.textItems!.assetNames.filter(s => strs.indexOf(s) === -1),\n                other: this.state.textItems!.other.filter(s => strs.indexOf(s) === -1),\n                variableNames: this.state.textItems!.variableNames.filter(s => strs.indexOf(s) === -1),\n            }\n        });\n    }\n\n    async approveAllImagesAsync() {\n        for (const item of this.state.items) {\n            if (await isStringApprovedAsync(item.jres.previewURI)) continue;\n\n            await markStringApprovedAsync(item.jres.previewURI);\n        }\n\n        this.setState({\n            items: []\n        })\n    }\n\n    render() {\n        const { items, selected, dragging, alert, textItems, files, runUrl, isDeleted } = this.state;\n\n        const { variableNames, assetNames, other } = textItems || {};\n\n        return <div id=\"asset-list\" onPaste={this.onPaste}>\n            {alert && <Alert icon={alert.icon} title={alert.title} text={alert.text} options={alert.options} visible={true} onClose={this.hideAlert}>\n                {alert.type === \"import\" && <div className=\"asset-import\">\n                    <div className={`asset-drop ${dragging ? \"dragging\" : \"\"}`} ref={this.handleDropRef} onDragEnter={this.onImportDragEnter} onDragLeave={this.onImportDragLeave}>\n                        Drop PNG files here to import.\n                    </div>\n                    <input ref={this.handleImportInputRef} onPaste={this.onPaste} placeholder=\"https://makecode.com/_r8fboJQTDPtH or https://arcade.makeode.com/62736-71128-62577-28722\" />\n                </div>}\n                {alert.type === \"export\" && <div className=\"asset-export\">\n                    <input ref={this.handleExportInputRef} placeholder=\"Enter a name for your project...\" />\n                </div>}\n            </Alert>}\n            <div className=\"asset-list-buttons\">\n            </div>\n            { !!items.length &&\n                <>\n                    <div className=\"asset-images\">\n                        { items.map((item, i) => {\n                            return <Asset\n                                key={i}\n                                info={item}\n                                selected={i === selected}\n                                onClick={this.onAssetClick(i)}\n                                onRename={this.onAssetRename(i)}\n                                onDelete={this.onAssetDelete} />\n                        }) }\n                    </div>\n                    <div>\n                        <button onClick={() => this.approveAllImagesAsync()}>Approve All Images</button>\n                    </div>\n                </>\n            }\n            {!!variableNames?.length && <div className=\"asset-files\">\n                <div className=\"asset-filename\">Variables</div>\n                <pre className=\"asset-file-content\">{variableNames.join(\"\\n\")}</pre>\n                <button onClick={() => this.approveAllStringsAsync(\"variableNames\")}>Approve All Variables</button>\n            </div>}\n            {!!assetNames?.length &&  <div className=\"asset-files\">\n                <div className=\"asset-filename\">Asset Names</div>\n                <pre className=\"asset-file-content\">{assetNames.join(\"\\n\")}</pre>\n                <button onClick={() => this.approveAllStringsAsync(\"assetNames\")}>Approve All Names</button>\n            </div>}\n            { !!other?.length && <div className=\"asset-files\">\n                <div className=\"asset-filename\">Strings</div>\n                <pre className=\"asset-file-content\">{other.join(\"\\n\")}</pre>\n            <   button onClick={() => this.approveAllStringsAsync(\"other\")}>Approve All Strings</button>\n            </div>\n            }\n            {!!files?.length && <div className=\"asset-files\">\n                    {files.map((file, i) => <div key={i} className=\"asset-file\">\n                        <div className=\"asset-filename\">{file.name}</div>\n                        <pre className=\"asset-file-content scroll\">{file.content}</pre>\n                </div>)}\n            </div>\n            }\n            {isDeleted && <div className=\"banned-script\">\n                <h1>\n                    This script has been deleted by content moderation, and will not show up to users!\n                </h1>\n            </div>}\n            {runUrl && <div className=\"sim-embed asset-files\">\n                <iframe src={runUrl} sandbox=\"allow-popups allow-forms allow-scripts allow-same-origin\"></iframe>\n            </div>}\n        </div>\n    }\n}\n\nexport default AssetList","import React from 'react';\nimport AssetList from './components/AssetList';\nimport './styles/App.css';\n\nclass App extends React.Component {\n    componentDidMount() {\n    }\n\n    render() {\n        return (\n            <div className=\"app\">\n                <AssetList postMessage={() => {}} />\n            </div>\n        );\n    }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}